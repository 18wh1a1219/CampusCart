b5f9ed3516413f5f5acd6b4859204a44
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _Platform = _interopRequireDefault(require("../../Utilities/Platform"));

var React = _interopRequireWildcard(require("react"));

var _StyleSheet = _interopRequireDefault(require("../../StyleSheet/StyleSheet"));

var _useMergeRefs = _interopRequireDefault(require("../../Utilities/useMergeRefs"));

var _AndroidSwitchNativeComponent = _interopRequireWildcard(require("./AndroidSwitchNativeComponent"));

var _SwitchNativeComponent = _interopRequireWildcard(require("./SwitchNativeComponent"));

var _excluded = ["disabled", "ios_backgroundColor", "onChange", "onValueChange", "style", "thumbColor", "trackColor", "value"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

var returnsFalse = function returnsFalse() {
  return false;
};

var returnsTrue = function returnsTrue() {
  return true;
};

var SwitchWithForwardedRef = React.forwardRef(function Switch(props, forwardedRef) {
  var disabled = props.disabled,
      ios_backgroundColor = props.ios_backgroundColor,
      onChange = props.onChange,
      onValueChange = props.onValueChange,
      style = props.style,
      thumbColor = props.thumbColor,
      trackColor = props.trackColor,
      value = props.value,
      restProps = (0, _objectWithoutProperties2.default)(props, _excluded);
  var trackColorForFalse = trackColor == null ? void 0 : trackColor.false;
  var trackColorForTrue = trackColor == null ? void 0 : trackColor.true;
  var nativeSwitchRef = React.useRef(null);
  var ref = (0, _useMergeRefs.default)(nativeSwitchRef, forwardedRef);

  var _React$useState = React.useState({
    value: null
  }),
      _React$useState2 = (0, _slicedToArray2.default)(_React$useState, 2),
      native = _React$useState2[0],
      setNative = _React$useState2[1];

  var handleChange = function handleChange(event) {
    onChange == null ? void 0 : onChange(event);
    onValueChange == null ? void 0 : onValueChange(event.nativeEvent.value);
    setNative({
      value: event.nativeEvent.value
    });
  };

  React.useLayoutEffect(function () {
    var _nativeSwitchRef$curr;

    var jsValue = value === true;
    var shouldUpdateNativeSwitch = native.value != null && native.value !== jsValue;

    if (shouldUpdateNativeSwitch && ((_nativeSwitchRef$curr = nativeSwitchRef.current) == null ? void 0 : _nativeSwitchRef$curr.setNativeProps) != null) {
      if (_Platform.default.OS === 'android') {
        _AndroidSwitchNativeComponent.Commands.setNativeValue(nativeSwitchRef.current, jsValue);
      } else {
        _SwitchNativeComponent.Commands.setValue(nativeSwitchRef.current, jsValue);
      }
    }
  }, [value, native]);

  if (_Platform.default.OS === 'android') {
    var _props$accessibilityR;

    var platformProps = {
      enabled: disabled !== true,
      on: value === true,
      style: style,
      thumbTintColor: thumbColor,
      trackColorForFalse: trackColorForFalse,
      trackColorForTrue: trackColorForTrue,
      trackTintColor: value === true ? trackColorForTrue : trackColorForFalse
    };
    return React.createElement(_AndroidSwitchNativeComponent.default, (0, _extends2.default)({}, restProps, platformProps, {
      accessibilityRole: (_props$accessibilityR = props.accessibilityRole) != null ? _props$accessibilityR : 'switch',
      onChange: handleChange,
      onResponderTerminationRequest: returnsFalse,
      onStartShouldSetResponder: returnsTrue,
      ref: ref
    }));
  } else {
    var _props$accessibilityR2;

    var _platformProps = {
      disabled: disabled,
      onTintColor: trackColorForTrue,
      style: _StyleSheet.default.compose({
        height: 31,
        width: 51
      }, _StyleSheet.default.compose(style, ios_backgroundColor == null ? null : {
        backgroundColor: ios_backgroundColor,
        borderRadius: 16
      })),
      thumbTintColor: thumbColor,
      tintColor: trackColorForFalse,
      value: value === true
    };
    return React.createElement(_SwitchNativeComponent.default, (0, _extends2.default)({}, restProps, _platformProps, {
      accessibilityRole: (_props$accessibilityR2 = props.accessibilityRole) != null ? _props$accessibilityR2 : 'switch',
      onChange: handleChange,
      onResponderTerminationRequest: returnsFalse,
      onStartShouldSetResponder: returnsTrue,
      ref: ref
    }));
  }
});
var _default = SwitchWithForwardedRef;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXR1cm5zRmFsc2UiLCJyZXR1cm5zVHJ1ZSIsIlN3aXRjaFdpdGhGb3J3YXJkZWRSZWYiLCJSZWFjdCIsImZvcndhcmRSZWYiLCJTd2l0Y2giLCJwcm9wcyIsImZvcndhcmRlZFJlZiIsImRpc2FibGVkIiwiaW9zX2JhY2tncm91bmRDb2xvciIsIm9uQ2hhbmdlIiwib25WYWx1ZUNoYW5nZSIsInN0eWxlIiwidGh1bWJDb2xvciIsInRyYWNrQ29sb3IiLCJ2YWx1ZSIsInJlc3RQcm9wcyIsInRyYWNrQ29sb3JGb3JGYWxzZSIsImZhbHNlIiwidHJhY2tDb2xvckZvclRydWUiLCJ0cnVlIiwibmF0aXZlU3dpdGNoUmVmIiwidXNlUmVmIiwicmVmIiwidXNlU3RhdGUiLCJuYXRpdmUiLCJzZXROYXRpdmUiLCJoYW5kbGVDaGFuZ2UiLCJldmVudCIsIm5hdGl2ZUV2ZW50IiwidXNlTGF5b3V0RWZmZWN0IiwianNWYWx1ZSIsInNob3VsZFVwZGF0ZU5hdGl2ZVN3aXRjaCIsImN1cnJlbnQiLCJzZXROYXRpdmVQcm9wcyIsIlBsYXRmb3JtIiwiT1MiLCJBbmRyb2lkU3dpdGNoQ29tbWFuZHMiLCJzZXROYXRpdmVWYWx1ZSIsIlN3aXRjaENvbW1hbmRzIiwic2V0VmFsdWUiLCJwbGF0Zm9ybVByb3BzIiwiZW5hYmxlZCIsIm9uIiwidGh1bWJUaW50Q29sb3IiLCJ0cmFja1RpbnRDb2xvciIsImFjY2Vzc2liaWxpdHlSb2xlIiwib25UaW50Q29sb3IiLCJTdHlsZVNoZWV0IiwiY29tcG9zZSIsImhlaWdodCIsIndpZHRoIiwiYmFja2dyb3VuZENvbG9yIiwiYm9yZGVyUmFkaXVzIiwidGludENvbG9yIl0sInNvdXJjZXMiOlsiU3dpdGNoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqIEBnZW5lcmF0ZS1kb2NzXG4gKi9cblxuaW1wb3J0IFBsYXRmb3JtIGZyb20gJy4uLy4uL1V0aWxpdGllcy9QbGF0Zm9ybSc7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgU3R5bGVTaGVldCBmcm9tICcuLi8uLi9TdHlsZVNoZWV0L1N0eWxlU2hlZXQnO1xuaW1wb3J0IHVzZU1lcmdlUmVmcyBmcm9tICcuLi8uLi9VdGlsaXRpZXMvdXNlTWVyZ2VSZWZzJztcblxuaW1wb3J0IEFuZHJvaWRTd2l0Y2hOYXRpdmVDb21wb25lbnQsIHtcbiAgQ29tbWFuZHMgYXMgQW5kcm9pZFN3aXRjaENvbW1hbmRzLFxufSBmcm9tICcuL0FuZHJvaWRTd2l0Y2hOYXRpdmVDb21wb25lbnQnO1xuaW1wb3J0IFN3aXRjaE5hdGl2ZUNvbXBvbmVudCwge1xuICBDb21tYW5kcyBhcyBTd2l0Y2hDb21tYW5kcyxcbn0gZnJvbSAnLi9Td2l0Y2hOYXRpdmVDb21wb25lbnQnO1xuXG5pbXBvcnQgdHlwZSB7Q29sb3JWYWx1ZX0gZnJvbSAnLi4vLi4vU3R5bGVTaGVldC9TdHlsZVNoZWV0JztcbmltcG9ydCB0eXBlIHtTeW50aGV0aWNFdmVudH0gZnJvbSAnLi4vLi4vVHlwZXMvQ29yZUV2ZW50VHlwZXMnO1xuaW1wb3J0IHR5cGUge1ZpZXdQcm9wc30gZnJvbSAnLi4vVmlldy9WaWV3UHJvcFR5cGVzJztcblxudHlwZSBTd2l0Y2hDaGFuZ2VFdmVudCA9IFN5bnRoZXRpY0V2ZW50PFxuICAkUmVhZE9ubHk8e3xcbiAgICB2YWx1ZTogYm9vbGVhbixcbiAgfH0+LFxuPjtcblxuZXhwb3J0IHR5cGUgUHJvcHMgPSAkUmVhZE9ubHk8e3xcbiAgLi4uVmlld1Byb3BzLFxuXG4gIC8qKlxuICAgIElmIHRydWUgdGhlIHVzZXIgd29uJ3QgYmUgYWJsZSB0byB0b2dnbGUgdGhlIHN3aXRjaC5cblxuICAgIEBkZWZhdWx0IGZhbHNlXG4gICAqL1xuICBkaXNhYmxlZD86ID9ib29sZWFuLFxuXG4gIC8qKlxuICAgIFRoZSB2YWx1ZSBvZiB0aGUgc3dpdGNoLiBJZiB0cnVlIHRoZSBzd2l0Y2ggd2lsbCBiZSB0dXJuZWQgb24uXG5cbiAgICBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgdmFsdWU/OiA/Ym9vbGVhbixcblxuICAvKipcbiAgICBDb2xvciBvZiB0aGUgZm9yZWdyb3VuZCBzd2l0Y2ggZ3JpcC4gSWYgdGhpcyBpcyBzZXQgb24gaU9TLCB0aGUgc3dpdGNoIGdyaXAgd2lsbCBsb3NlIGl0cyBkcm9wIHNoYWRvdy5cbiAgICovXG4gIHRodW1iQ29sb3I/OiA/Q29sb3JWYWx1ZSxcblxuICAvKipcbiAgICBDdXN0b20gY29sb3JzIGZvciB0aGUgc3dpdGNoIHRyYWNrLlxuXG4gICAgX2lPU186IFdoZW4gdGhlIHN3aXRjaCB2YWx1ZSBpcyBmYWxzZSwgdGhlIHRyYWNrIHNocmlua3MgaW50byB0aGUgYm9yZGVyLiBJZiB5b3Ugd2FudCB0byBjaGFuZ2UgdGhlXG4gICAgY29sb3Igb2YgdGhlIGJhY2tncm91bmQgZXhwb3NlZCBieSB0aGUgc2hydW5rZW4gdHJhY2ssIHVzZVxuICAgICBbYGlvc19iYWNrZ3JvdW5kQ29sb3JgXShodHRwczovL3JlYWN0bmF0aXZlLmRldi9kb2NzL3N3aXRjaCNpb3NfYmFja2dyb3VuZENvbG9yKS5cbiAgICovXG4gIHRyYWNrQ29sb3I/OiA/JFJlYWRPbmx5PHt8XG4gICAgZmFsc2U/OiA/Q29sb3JWYWx1ZSxcbiAgICB0cnVlPzogP0NvbG9yVmFsdWUsXG4gIHx9PixcblxuICAvKipcbiAgICBPbiBpT1MsIGN1c3RvbSBjb2xvciBmb3IgdGhlIGJhY2tncm91bmQuIFRoaXMgYmFja2dyb3VuZCBjb2xvciBjYW4gYmVcbiAgICBzZWVuIGVpdGhlciB3aGVuIHRoZSBzd2l0Y2ggdmFsdWUgaXMgZmFsc2Ugb3Igd2hlbiB0aGUgc3dpdGNoIGlzXG4gICAgZGlzYWJsZWQgKGFuZCB0aGUgc3dpdGNoIGlzIHRyYW5zbHVjZW50KS5cbiAgICovXG4gIGlvc19iYWNrZ3JvdW5kQ29sb3I/OiA/Q29sb3JWYWx1ZSxcblxuICAvKipcbiAgICBJbnZva2VkIHdoZW4gdGhlIHVzZXIgdHJpZXMgdG8gY2hhbmdlIHRoZSB2YWx1ZSBvZiB0aGUgc3dpdGNoLiBSZWNlaXZlc1xuICAgIHRoZSBjaGFuZ2UgZXZlbnQgYXMgYW4gYXJndW1lbnQuIElmIHlvdSB3YW50IHRvIG9ubHkgcmVjZWl2ZSB0aGUgbmV3XG4gICAgdmFsdWUsIHVzZSBgb25WYWx1ZUNoYW5nZWAgaW5zdGVhZC5cbiAgICovXG4gIG9uQ2hhbmdlPzogPyhldmVudDogU3dpdGNoQ2hhbmdlRXZlbnQpID0+IFByb21pc2U8dm9pZD4gfCB2b2lkLFxuXG4gIC8qKlxuICAgIEludm9rZWQgd2hlbiB0aGUgdXNlciB0cmllcyB0byBjaGFuZ2UgdGhlIHZhbHVlIG9mIHRoZSBzd2l0Y2guIFJlY2VpdmVzXG4gICAgdGhlIG5ldyB2YWx1ZSBhcyBhbiBhcmd1bWVudC4gSWYgeW91IHdhbnQgdG8gaW5zdGVhZCByZWNlaXZlIGFuIGV2ZW50LFxuICAgIHVzZSBgb25DaGFuZ2VgLlxuICAgKi9cbiAgb25WYWx1ZUNoYW5nZT86ID8odmFsdWU6IGJvb2xlYW4pID0+IFByb21pc2U8dm9pZD4gfCB2b2lkLFxufH0+O1xuY29uc3QgcmV0dXJuc0ZhbHNlID0gKCkgPT4gZmFsc2U7XG5jb25zdCByZXR1cm5zVHJ1ZSA9ICgpID0+IHRydWU7XG5cbi8qKlxuICBSZW5kZXJzIGEgYm9vbGVhbiBpbnB1dC5cblxuICBUaGlzIGlzIGEgY29udHJvbGxlZCBjb21wb25lbnQgdGhhdCByZXF1aXJlcyBhbiBgb25WYWx1ZUNoYW5nZWBcbiAgY2FsbGJhY2sgdGhhdCB1cGRhdGVzIHRoZSBgdmFsdWVgIHByb3AgaW4gb3JkZXIgZm9yIHRoZSBjb21wb25lbnQgdG9cbiAgcmVmbGVjdCB1c2VyIGFjdGlvbnMuIElmIHRoZSBgdmFsdWVgIHByb3AgaXMgbm90IHVwZGF0ZWQsIHRoZVxuICBjb21wb25lbnQgd2lsbCBjb250aW51ZSB0byByZW5kZXIgdGhlIHN1cHBsaWVkIGB2YWx1ZWAgcHJvcCBpbnN0ZWFkIG9mXG4gIHRoZSBleHBlY3RlZCByZXN1bHQgb2YgYW55IHVzZXIgYWN0aW9ucy5cblxuICBgYGBTbmFja1BsYXllciBuYW1lPVN3aXRjaFxuICBpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbiAgaW1wb3J0IHsgVmlldywgU3dpdGNoLCBTdHlsZVNoZWV0IH0gZnJvbSBcInJlYWN0LW5hdGl2ZVwiO1xuXG4gIGNvbnN0IEFwcCA9ICgpID0+IHtcbiAgICBjb25zdCBbaXNFbmFibGVkLCBzZXRJc0VuYWJsZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IHRvZ2dsZVN3aXRjaCA9ICgpID0+IHNldElzRW5hYmxlZChwcmV2aW91c1N0YXRlID0+ICFwcmV2aW91c1N0YXRlKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8VmlldyBzdHlsZT17c3R5bGVzLmNvbnRhaW5lcn0+XG4gICAgICAgIDxTd2l0Y2hcbiAgICAgICAgICB0cmFja0NvbG9yPXt7IGZhbHNlOiBcIiM3Njc1NzdcIiwgdHJ1ZTogXCIjODFiMGZmXCIgfX1cbiAgICAgICAgICB0aHVtYkNvbG9yPXtpc0VuYWJsZWQgPyBcIiNmNWRkNGJcIiA6IFwiI2Y0ZjNmNFwifVxuICAgICAgICAgIGlvc19iYWNrZ3JvdW5kQ29sb3I9XCIjM2UzZTNlXCJcbiAgICAgICAgICBvblZhbHVlQ2hhbmdlPXt0b2dnbGVTd2l0Y2h9XG4gICAgICAgICAgdmFsdWU9e2lzRW5hYmxlZH1cbiAgICAgICAgLz5cbiAgICAgIDwvVmlldz5cbiAgICApO1xuICB9XG5cbiAgY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICAgIGNvbnRhaW5lcjoge1xuICAgICAgZmxleDogMSxcbiAgICAgIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsXG4gICAgICBqdXN0aWZ5Q29udGVudDogXCJjZW50ZXJcIlxuICAgIH1cbiAgfSk7XG5cbiAgZXhwb3J0IGRlZmF1bHQgQXBwO1xuICBgYGBcbiAqL1xuXG5jb25zdCBTd2l0Y2hXaXRoRm9yd2FyZGVkUmVmOiBSZWFjdC5BYnN0cmFjdENvbXBvbmVudDxcbiAgUHJvcHMsXG4gIFJlYWN0LkVsZW1lbnRSZWY8XG4gICAgdHlwZW9mIFN3aXRjaE5hdGl2ZUNvbXBvbmVudCB8IHR5cGVvZiBBbmRyb2lkU3dpdGNoTmF0aXZlQ29tcG9uZW50LFxuICA+LFxuPiA9IFJlYWN0LmZvcndhcmRSZWYoZnVuY3Rpb24gU3dpdGNoKHByb3BzLCBmb3J3YXJkZWRSZWYpOiBSZWFjdC5Ob2RlIHtcbiAgY29uc3Qge1xuICAgIGRpc2FibGVkLFxuICAgIGlvc19iYWNrZ3JvdW5kQ29sb3IsXG4gICAgb25DaGFuZ2UsXG4gICAgb25WYWx1ZUNoYW5nZSxcbiAgICBzdHlsZSxcbiAgICB0aHVtYkNvbG9yLFxuICAgIHRyYWNrQ29sb3IsXG4gICAgdmFsdWUsXG4gICAgLi4ucmVzdFByb3BzXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgdHJhY2tDb2xvckZvckZhbHNlID0gdHJhY2tDb2xvcj8uZmFsc2U7XG4gIGNvbnN0IHRyYWNrQ29sb3JGb3JUcnVlID0gdHJhY2tDb2xvcj8udHJ1ZTtcblxuICBjb25zdCBuYXRpdmVTd2l0Y2hSZWYgPSBSZWFjdC51c2VSZWY8UmVhY3QuRWxlbWVudFJlZjxcbiAgICB0eXBlb2YgU3dpdGNoTmF0aXZlQ29tcG9uZW50IHwgdHlwZW9mIEFuZHJvaWRTd2l0Y2hOYXRpdmVDb21wb25lbnQsXG4gID4gfCBudWxsPihudWxsKTtcblxuICBjb25zdCByZWYgPSB1c2VNZXJnZVJlZnMobmF0aXZlU3dpdGNoUmVmLCBmb3J3YXJkZWRSZWYpO1xuXG4gIGNvbnN0IFtuYXRpdmUsIHNldE5hdGl2ZV0gPSBSZWFjdC51c2VTdGF0ZSh7dmFsdWU6IG51bGx9KTtcblxuICBjb25zdCBoYW5kbGVDaGFuZ2UgPSAoZXZlbnQ6IFN3aXRjaENoYW5nZUV2ZW50KSA9PiB7XG4gICAgb25DaGFuZ2U/LihldmVudCk7XG4gICAgb25WYWx1ZUNoYW5nZT8uKGV2ZW50Lm5hdGl2ZUV2ZW50LnZhbHVlKTtcbiAgICBzZXROYXRpdmUoe3ZhbHVlOiBldmVudC5uYXRpdmVFdmVudC52YWx1ZX0pO1xuICB9O1xuXG4gIFJlYWN0LnVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgaW4gY2FzZSBuYXRpdmUgdXBkYXRlcyB0aGUgc3dpdGNoIGFuZCBKUyBkZWNpZGVzXG4gICAgLy8gdGhhdCB0aGUgdXBkYXRlIHNob3VsZCBiZSBpZ25vcmVkIGFuZCB3ZSBzaG91bGQgc3RpY2sgd2l0aCB0aGUgdmFsdWVcbiAgICAvLyB0aGF0IHdlIGhhdmUgaW4gSlMuXG4gICAgY29uc3QganNWYWx1ZSA9IHZhbHVlID09PSB0cnVlO1xuICAgIGNvbnN0IHNob3VsZFVwZGF0ZU5hdGl2ZVN3aXRjaCA9XG4gICAgICBuYXRpdmUudmFsdWUgIT0gbnVsbCAmJiBuYXRpdmUudmFsdWUgIT09IGpzVmFsdWU7XG4gICAgaWYgKFxuICAgICAgc2hvdWxkVXBkYXRlTmF0aXZlU3dpdGNoICYmXG4gICAgICBuYXRpdmVTd2l0Y2hSZWYuY3VycmVudD8uc2V0TmF0aXZlUHJvcHMgIT0gbnVsbFxuICAgICkge1xuICAgICAgaWYgKFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCcpIHtcbiAgICAgICAgQW5kcm9pZFN3aXRjaENvbW1hbmRzLnNldE5hdGl2ZVZhbHVlKG5hdGl2ZVN3aXRjaFJlZi5jdXJyZW50LCBqc1ZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN3aXRjaENvbW1hbmRzLnNldFZhbHVlKG5hdGl2ZVN3aXRjaFJlZi5jdXJyZW50LCBqc1ZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFt2YWx1ZSwgbmF0aXZlXSk7XG5cbiAgaWYgKFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCcpIHtcbiAgICBjb25zdCBwbGF0Zm9ybVByb3BzID0ge1xuICAgICAgZW5hYmxlZDogZGlzYWJsZWQgIT09IHRydWUsXG4gICAgICBvbjogdmFsdWUgPT09IHRydWUsXG4gICAgICBzdHlsZSxcbiAgICAgIHRodW1iVGludENvbG9yOiB0aHVtYkNvbG9yLFxuICAgICAgdHJhY2tDb2xvckZvckZhbHNlOiB0cmFja0NvbG9yRm9yRmFsc2UsXG4gICAgICB0cmFja0NvbG9yRm9yVHJ1ZTogdHJhY2tDb2xvckZvclRydWUsXG4gICAgICB0cmFja1RpbnRDb2xvcjogdmFsdWUgPT09IHRydWUgPyB0cmFja0NvbG9yRm9yVHJ1ZSA6IHRyYWNrQ29sb3JGb3JGYWxzZSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxBbmRyb2lkU3dpdGNoTmF0aXZlQ29tcG9uZW50XG4gICAgICAgIHsuLi5yZXN0UHJvcHN9XG4gICAgICAgIHsuLi5wbGF0Zm9ybVByb3BzfVxuICAgICAgICBhY2Nlc3NpYmlsaXR5Um9sZT17cHJvcHMuYWNjZXNzaWJpbGl0eVJvbGUgPz8gJ3N3aXRjaCd9XG4gICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9XG4gICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0PXtyZXR1cm5zRmFsc2V9XG4gICAgICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXI9e3JldHVybnNUcnVlfVxuICAgICAgICByZWY9e3JlZn1cbiAgICAgIC8+XG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBwbGF0Zm9ybVByb3BzID0ge1xuICAgICAgZGlzYWJsZWQsXG4gICAgICBvblRpbnRDb2xvcjogdHJhY2tDb2xvckZvclRydWUsXG4gICAgICBzdHlsZTogU3R5bGVTaGVldC5jb21wb3NlKFxuICAgICAgICB7aGVpZ2h0OiAzMSwgd2lkdGg6IDUxfSxcbiAgICAgICAgU3R5bGVTaGVldC5jb21wb3NlKFxuICAgICAgICAgIHN0eWxlLFxuICAgICAgICAgIGlvc19iYWNrZ3JvdW5kQ29sb3IgPT0gbnVsbFxuICAgICAgICAgICAgPyBudWxsXG4gICAgICAgICAgICA6IHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGlvc19iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAxNixcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgKSxcbiAgICAgICksXG4gICAgICB0aHVtYlRpbnRDb2xvcjogdGh1bWJDb2xvcixcbiAgICAgIHRpbnRDb2xvcjogdHJhY2tDb2xvckZvckZhbHNlLFxuICAgICAgdmFsdWU6IHZhbHVlID09PSB0cnVlLFxuICAgIH07XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFN3aXRjaE5hdGl2ZUNvbXBvbmVudFxuICAgICAgICB7Li4ucmVzdFByb3BzfVxuICAgICAgICB7Li4ucGxhdGZvcm1Qcm9wc31cbiAgICAgICAgYWNjZXNzaWJpbGl0eVJvbGU9e3Byb3BzLmFjY2Vzc2liaWxpdHlSb2xlID8/ICdzd2l0Y2gnfVxuICAgICAgICBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfVxuICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdD17cmV0dXJuc0ZhbHNlfVxuICAgICAgICBvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyPXtyZXR1cm5zVHJ1ZX1cbiAgICAgICAgcmVmPXtyZWZ9XG4gICAgICAvPlxuICAgICk7XG4gIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBTd2l0Y2hXaXRoRm9yd2FyZGVkUmVmO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBV0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBR0E7Ozs7Ozs7O0FBcUVBLElBQU1BLFlBQVksR0FBRyxTQUFmQSxZQUFlO0VBQUEsT0FBTSxLQUFOO0FBQUEsQ0FBckI7O0FBQ0EsSUFBTUMsV0FBVyxHQUFH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