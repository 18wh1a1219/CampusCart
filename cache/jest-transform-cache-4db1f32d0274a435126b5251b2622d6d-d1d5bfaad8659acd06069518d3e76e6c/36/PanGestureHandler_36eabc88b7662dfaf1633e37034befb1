7b3dad6120592cd9e60ee46f7737f974
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.managePanProps = managePanProps;
exports.PanGestureHandler = exports.panGestureHandlerCustomNativeProps = exports.panGestureHandlerProps = void 0;

var _createHandler = _interopRequireDefault(require("./createHandler"));

var _gestureHandlerCommon = require("./gestureHandlerCommon");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

var panGestureHandlerProps = ['activeOffsetY', 'activeOffsetX', 'failOffsetY', 'failOffsetX', 'minDist', 'minVelocity', 'minVelocityX', 'minVelocityY', 'minPointers', 'maxPointers', 'avgTouches', 'enableTrackpadTwoFingerGesture'];
exports.panGestureHandlerProps = panGestureHandlerProps;
var panGestureHandlerCustomNativeProps = ['activeOffsetYStart', 'activeOffsetYEnd', 'activeOffsetXStart', 'activeOffsetXEnd', 'failOffsetYStart', 'failOffsetYEnd', 'failOffsetXStart', 'failOffsetXEnd'];
exports.panGestureHandlerCustomNativeProps = panGestureHandlerCustomNativeProps;
var PanGestureHandler = (0, _createHandler.default)({
  name: 'PanGestureHandler',
  allowedProps: [].concat((0, _toConsumableArray2.default)(_gestureHandlerCommon.baseGestureHandlerProps), panGestureHandlerProps),
  config: {},
  transformProps: managePanProps,
  customNativeProps: panGestureHandlerCustomNativeProps
});
exports.PanGestureHandler = PanGestureHandler;

function validatePanGestureHandlerProps(props) {
  if (Array.isArray(props.activeOffsetX) && (props.activeOffsetX[0] > 0 || props.activeOffsetX[1] < 0)) {
    throw new Error("First element of activeOffsetX should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.activeOffsetY) && (props.activeOffsetY[0] > 0 || props.activeOffsetY[1] < 0)) {
    throw new Error("First element of activeOffsetY should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.failOffsetX) && (props.failOffsetX[0] > 0 || props.failOffsetX[1] < 0)) {
    throw new Error("First element of failOffsetX should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.failOffsetY) && (props.failOffsetY[0] > 0 || props.failOffsetY[1] < 0)) {
    throw new Error("First element of failOffsetY should be negative, a the second one should be positive");
  }

  if (props.minDist && (props.failOffsetX || props.failOffsetY)) {
    throw new Error("It is not supported to use minDist with failOffsetX or failOffsetY, use activeOffsetX and activeOffsetY instead");
  }

  if (props.minDist && (props.activeOffsetX || props.activeOffsetY)) {
    throw new Error("It is not supported to use minDist with activeOffsetX or activeOffsetY");
  }
}

function transformPanGestureHandlerProps(props) {
  var res = (0, _extends2.default)({}, props);

  if (props.activeOffsetX !== undefined) {
    delete res.activeOffsetX;

    if (Array.isArray(props.activeOffsetX)) {
      res.activeOffsetXStart = props.activeOffsetX[0];
      res.activeOffsetXEnd = props.activeOffsetX[1];
    } else if (props.activeOffsetX < 0) {
      res.activeOffsetXStart = props.activeOffsetX;
    } else {
      res.activeOffsetXEnd = props.activeOffsetX;
    }
  }

  if (props.activeOffsetY !== undefined) {
    delete res.activeOffsetY;

    if (Array.isArray(props.activeOffsetY)) {
      res.activeOffsetYStart = props.activeOffsetY[0];
      res.activeOffsetYEnd = props.activeOffsetY[1];
    } else if (props.activeOffsetY < 0) {
      res.activeOffsetYStart = props.activeOffsetY;
    } else {
      res.activeOffsetYEnd = props.activeOffsetY;
    }
  }

  if (props.failOffsetX !== undefined) {
    delete res.failOffsetX;

    if (Array.isArray(props.failOffsetX)) {
      res.failOffsetXStart = props.failOffsetX[0];
      res.failOffsetXEnd = props.failOffsetX[1];
    } else if (props.failOffsetX < 0) {
      res.failOffsetXStart = props.failOffsetX;
    } else {
      res.failOffsetXEnd = props.failOffsetX;
    }
  }

  if (props.failOffsetY !== undefined) {
    delete res.failOffsetY;

    if (Array.isArray(props.failOffsetY)) {
      res.failOffsetYStart = props.failOffsetY[0];
      res.failOffsetYEnd = props.failOffsetY[1];
    } else if (props.failOffsetY < 0) {
      res.failOffsetYStart = props.failOffsetY;
    } else {
      res.failOffsetYEnd = props.failOffsetY;
    }
  }

  return res;
}

function managePanProps(props) {
  if (__DEV__) {
    validatePanGestureHandlerProps(props);
  }

  return transformPanGestureHandlerProps(props);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNULEtBQUQsQ0FBdEM7QUFDRCIsIm5hbWVzIjpbInBhbkdlc3R1cmVIYW5kbGVyUHJvcHMiLCJwYW5HZXN0dXJlSGFuZGxlckN1c3RvbU5hdGl2ZVByb3BzIiwiUGFuR2VzdHVyZUhhbmRsZXIiLCJuYW1lIiwiYWxsb3dlZFByb3BzIiwiYmFzZUdlc3R1cmVIYW5kbGVyUHJvcHMiLCJjb25maWciLCJ0cmFuc2Zvcm1Qcm9wcyIsIm1hbmFnZVBhblByb3BzIiwiY3VzdG9tTmF0aXZlUHJvcHMiLCJ2YWxpZGF0ZVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMiLCJwcm9wcyIsIkFycmF5IiwiaXNBcnJheSIsImFjdGl2ZU9mZnNldFgiLCJFcnJvciIsImFjdGl2ZU9mZnNldFkiLCJmYWlsT2Zmc2V0WCIsImZhaWxPZmZzZXRZIiwibWluRGlzdCIsInRyYW5zZm9ybVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMiLCJyZXMiLCJ1bmRlZmluZWQiLCJhY3RpdmVPZmZzZXRYU3RhcnQiLCJhY3RpdmVPZmZzZXRYRW5kIiwiYWN0aXZlT2Zmc2V0WVN0YXJ0IiwiYWN0aXZlT2Zmc2V0WUVuZCIsImZhaWxPZmZzZXRYU3RhcnQiLCJmYWlsT2Zmc2V0WEVuZCIsImZhaWxPZmZzZXRZU3RhcnQiLCJmYWlsT2Zmc2V0WUVuZCIsIl9fREVWX18iXSwic291cmNlcyI6WyJQYW5HZXN0dXJlSGFuZGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3JlYXRlSGFuZGxlciBmcm9tICcuL2NyZWF0ZUhhbmRsZXInO1xuaW1wb3J0IHtcbiAgQmFzZUdlc3R1cmVIYW5kbGVyUHJvcHMsXG4gIGJhc2VHZXN0dXJlSGFuZGxlclByb3BzLFxufSBmcm9tICcuL2dlc3R1cmVIYW5kbGVyQ29tbW9uJztcblxuZXhwb3J0IGNvbnN0IHBhbkdlc3R1cmVIYW5kbGVyUHJvcHMgPSBbXG4gICdhY3RpdmVPZmZzZXRZJyxcbiAgJ2FjdGl2ZU9mZnNldFgnLFxuICAnZmFpbE9mZnNldFknLFxuICAnZmFpbE9mZnNldFgnLFxuICAnbWluRGlzdCcsXG4gICdtaW5WZWxvY2l0eScsXG4gICdtaW5WZWxvY2l0eVgnLFxuICAnbWluVmVsb2NpdHlZJyxcbiAgJ21pblBvaW50ZXJzJyxcbiAgJ21heFBvaW50ZXJzJyxcbiAgJ2F2Z1RvdWNoZXMnLFxuICAnZW5hYmxlVHJhY2twYWRUd29GaW5nZXJHZXN0dXJlJyxcbl0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBwYW5HZXN0dXJlSGFuZGxlckN1c3RvbU5hdGl2ZVByb3BzID0gW1xuICAnYWN0aXZlT2Zmc2V0WVN0YXJ0JyxcbiAgJ2FjdGl2ZU9mZnNldFlFbmQnLFxuICAnYWN0aXZlT2Zmc2V0WFN0YXJ0JyxcbiAgJ2FjdGl2ZU9mZnNldFhFbmQnLFxuICAnZmFpbE9mZnNldFlTdGFydCcsXG4gICdmYWlsT2Zmc2V0WUVuZCcsXG4gICdmYWlsT2Zmc2V0WFN0YXJ0JyxcbiAgJ2ZhaWxPZmZzZXRYRW5kJyxcbl0gYXMgY29uc3Q7XG5cbmV4cG9ydCB0eXBlIFBhbkdlc3R1cmVIYW5kbGVyRXZlbnRQYXlsb2FkID0ge1xuICAvKipcbiAgICogWCBjb29yZGluYXRlIG9mIHRoZSBjdXJyZW50IHBvc2l0aW9uIG9mIHRoZSBwb2ludGVyIChmaW5nZXIgb3IgYSBsZWFkaW5nXG4gICAqIHBvaW50ZXIgd2hlbiB0aGVyZSBhcmUgbXVsdGlwbGUgZmluZ2VycyBwbGFjZWQpIHJlbGF0aXZlIHRvIHRoZSB2aWV3XG4gICAqIGF0dGFjaGVkIHRvIHRoZSBoYW5kbGVyLiBFeHByZXNzZWQgaW4gcG9pbnQgdW5pdHMuXG4gICAqL1xuICB4OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFkgY29vcmRpbmF0ZSBvZiB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgcG9pbnRlciAoZmluZ2VyIG9yIGEgbGVhZGluZ1xuICAgKiBwb2ludGVyIHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIGZpbmdlcnMgcGxhY2VkKSByZWxhdGl2ZSB0byB0aGUgdmlld1xuICAgKiBhdHRhY2hlZCB0byB0aGUgaGFuZGxlci4gRXhwcmVzc2VkIGluIHBvaW50IHVuaXRzLlxuICAgKi9cbiAgeTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBYIGNvb3JkaW5hdGUgb2YgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIHBvaW50ZXIgKGZpbmdlciBvciBhIGxlYWRpbmdcbiAgICogcG9pbnRlciB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBmaW5nZXJzIHBsYWNlZCkgcmVsYXRpdmUgdG8gdGhlIHJvb3Qgdmlldy5cbiAgICogVGhlIHZhbHVlIGlzIGV4cHJlc3NlZCBpbiBwb2ludCB1bml0cy4gSXQgaXMgcmVjb21tZW5kZWQgdG8gdXNlIGl0IGluc3RlYWRcbiAgICogb2YgYHhgIGluIGNhc2VzIHdoZW4gdGhlIG9yaWdpbmFsIHZpZXcgY2FuIGJlIHRyYW5zZm9ybWVkIGFzIGFuIGVmZmVjdCBvZlxuICAgKiB0aGUgZ2VzdHVyZS5cbiAgICovXG4gIGFic29sdXRlWDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBZIGNvb3JkaW5hdGUgb2YgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIHBvaW50ZXIgKGZpbmdlciBvciBhIGxlYWRpbmdcbiAgICogcG9pbnRlciB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBmaW5nZXJzIHBsYWNlZCkgcmVsYXRpdmUgdG8gdGhlIHJvb3Qgdmlldy5cbiAgICogVGhlIHZhbHVlIGlzIGV4cHJlc3NlZCBpbiBwb2ludCB1bml0cy4gSXQgaXMgcmVjb21tZW5kZWQgdG8gdXNlIGl0IGluc3RlYWRcbiAgICogb2YgYHlgIGluIGNhc2VzIHdoZW4gdGhlIG9yaWdpbmFsIHZpZXcgY2FuIGJlIHRyYW5zZm9ybWVkIGFzIGFuXG4gICAqIGVmZmVjdCBvZiB0aGUgZ2VzdHVyZS5cbiAgICovXG4gIGFic29sdXRlWTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUcmFuc2xhdGlvbiBvZiB0aGUgcGFuIGdlc3R1cmUgYWxvbmcgWCBheGlzIGFjY3VtdWxhdGVkIG92ZXIgdGhlIHRpbWUgb2ZcbiAgICogdGhlIGdlc3R1cmUuIFRoZSB2YWx1ZSBpcyBleHByZXNzZWQgaW4gdGhlIHBvaW50IHVuaXRzLlxuICAgKi9cbiAgdHJhbnNsYXRpb25YOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRyYW5zbGF0aW9uIG9mIHRoZSBwYW4gZ2VzdHVyZSBhbG9uZyBZIGF4aXMgYWNjdW11bGF0ZWQgb3ZlciB0aGUgdGltZSBvZlxuICAgKiB0aGUgZ2VzdHVyZS4gVGhlIHZhbHVlIGlzIGV4cHJlc3NlZCBpbiB0aGUgcG9pbnQgdW5pdHMuXG4gICAqL1xuICB0cmFuc2xhdGlvblk6IG51bWJlcjtcblxuICAvKipcbiAgICogVmVsb2NpdHkgb2YgdGhlIHBhbiBnZXN0dXJlIGFsb25nIHRoZSBYIGF4aXMgaW4gdGhlIGN1cnJlbnQgbW9tZW50LiBUaGVcbiAgICogdmFsdWUgaXMgZXhwcmVzc2VkIGluIHBvaW50IHVuaXRzIHBlciBzZWNvbmQuXG4gICAqL1xuICB2ZWxvY2l0eVg6IG51bWJlcjtcblxuICAvKipcbiAgICogVmVsb2NpdHkgb2YgdGhlIHBhbiBnZXN0dXJlIGFsb25nIHRoZSBZIGF4aXMgaW4gdGhlIGN1cnJlbnQgbW9tZW50LiBUaGVcbiAgICogdmFsdWUgaXMgZXhwcmVzc2VkIGluIHBvaW50IHVuaXRzIHBlciBzZWNvbmQuXG4gICAqL1xuICB2ZWxvY2l0eVk6IG51bWJlcjtcbn07XG5cbmludGVyZmFjZSBDb21tb25QYW5Qcm9wZXJ0aWVzIHtcbiAgLyoqXG4gICAqIE1pbmltdW0gZGlzdGFuY2UgdGhlIGZpbmdlciAob3IgbXVsdGlwbGUgZmluZ2VyKSBuZWVkIHRvIHRyYXZlbCBiZWZvcmUgdGhlXG4gICAqIGhhbmRsZXIgYWN0aXZhdGVzLiBFeHByZXNzZWQgaW4gcG9pbnRzLlxuICAgKi9cbiAgbWluRGlzdD86IG51bWJlcjtcblxuICAvKipcbiAgICogQW5kcm9pZCBvbmx5LlxuICAgKi9cbiAgYXZnVG91Y2hlcz86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEVuYWJsZXMgdHdvLWZpbmdlciBnZXN0dXJlcyBvbiBzdXBwb3J0ZWQgZGV2aWNlcywgZm9yIGV4YW1wbGUgaVBhZHMgd2l0aFxuICAgKiB0cmFja3BhZHMuIElmIG5vdCBlbmFibGVkIHRoZSBnZXN0dXJlIHdpbGwgcmVxdWlyZSBjbGljayArIGRyYWcsIHdpdGhcbiAgICogZW5hYmxlVHJhY2twYWRUd29GaW5nZXJHZXN0dXJlIHN3aXBpbmcgd2l0aCB0d28gZmluZ2VycyB3aWxsIGFsc28gdHJpZ2dlclxuICAgKiB0aGUgZ2VzdHVyZS5cbiAgICovXG4gIGVuYWJsZVRyYWNrcGFkVHdvRmluZ2VyR2VzdHVyZT86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEEgbnVtYmVyIG9mIGZpbmdlcnMgdGhhdCBpcyByZXF1aXJlZCB0byBiZSBwbGFjZWQgYmVmb3JlIGhhbmRsZXIgY2FuXG4gICAqIGFjdGl2YXRlLiBTaG91bGQgYmUgYSBoaWdoZXIgb3IgZXF1YWwgdG8gMCBpbnRlZ2VyLlxuICAgKi9cbiAgbWluUG9pbnRlcnM/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIGdpdmVuIG51bWJlciBvZiBmaW5nZXJzIGlzIHBsYWNlZCBvbiB0aGUgc2NyZWVuIGFuZCBoYW5kbGVyIGhhc24ndFxuICAgKiB5ZXQgYWN0aXZhdGVkIGl0IHdpbGwgZmFpbCByZWNvZ25pemluZyB0aGUgZ2VzdHVyZS4gU2hvdWxkIGJlIGEgaGlnaGVyIG9yXG4gICAqIGVxdWFsIHRvIDAgaW50ZWdlci5cbiAgICovXG4gIG1heFBvaW50ZXJzPzogbnVtYmVyO1xuXG4gIG1pblZlbG9jaXR5PzogbnVtYmVyO1xuICBtaW5WZWxvY2l0eVg/OiBudW1iZXI7XG4gIG1pblZlbG9jaXR5WT86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYW5HZXN0dXJlQ29uZmlnIGV4dGVuZHMgQ29tbW9uUGFuUHJvcGVydGllcyB7XG4gIGFjdGl2ZU9mZnNldFlTdGFydD86IG51bWJlcjtcbiAgYWN0aXZlT2Zmc2V0WUVuZD86IG51bWJlcjtcbiAgYWN0aXZlT2Zmc2V0WFN0YXJ0PzogbnVtYmVyO1xuICBhY3RpdmVPZmZzZXRYRW5kPzogbnVtYmVyO1xuICBmYWlsT2Zmc2V0WVN0YXJ0PzogbnVtYmVyO1xuICBmYWlsT2Zmc2V0WUVuZD86IG51bWJlcjtcbiAgZmFpbE9mZnNldFhTdGFydD86IG51bWJlcjtcbiAgZmFpbE9mZnNldFhFbmQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFuR2VzdHVyZUhhbmRsZXJQcm9wc1xuICBleHRlbmRzIEJhc2VHZXN0dXJlSGFuZGxlclByb3BzPFBhbkdlc3R1cmVIYW5kbGVyRXZlbnRQYXlsb2FkPixcbiAgICBDb21tb25QYW5Qcm9wZXJ0aWVzIHtcbiAgLyoqXG4gICAqIFJhbmdlIGFsb25nIFggYXhpcyAoaW4gcG9pbnRzKSB3aGVyZSBmaW5nZXJzIHRyYXZlbHMgd2l0aG91dCBhY3RpdmF0aW9uIG9mXG4gICAqIGhhbmRsZXIuIE1vdmluZyBvdXRzaWRlIG9mIHRoaXMgcmFuZ2UgaW1wbGllcyBhY3RpdmF0aW9uIG9mIGhhbmRsZXIuIFJhbmdlXG4gICAqIGNhbiBiZSBnaXZlbiBhcyBhbiBhcnJheSBvciBhIHNpbmdsZSBudW1iZXIuIElmIHJhbmdlIGlzIHNldCBhcyBhbiBhcnJheSxcbiAgICogZmlyc3QgdmFsdWUgbXVzdCBiZSBsb3dlciBvciBlcXVhbCB0byAwLCBhIHRoZSBzZWNvbmQgb25lIGhpZ2hlciBvciBlcXVhbFxuICAgKiB0byAwLiBJZiBvbmx5IG9uZSBudW1iZXIgYHBgIGlzIGdpdmVuIGEgcmFuZ2Ugb2YgYCgtaW5mLCBwKWAgd2lsbCBiZSB1c2VkXG4gICAqIGlmIGBwYCBpcyBoaWdoZXIgb3IgZXF1YWwgdG8gMCBhbmQgYCgtcCwgaW5mKWAgb3RoZXJ3aXNlLlxuICAgKi9cbiAgYWN0aXZlT2Zmc2V0WT86IG51bWJlciB8IG51bWJlcltdO1xuXG4gIC8qKlxuICAgKiBSYW5nZSBhbG9uZyBYIGF4aXMgKGluIHBvaW50cykgd2hlcmUgZmluZ2VycyB0cmF2ZWxzIHdpdGhvdXQgYWN0aXZhdGlvbiBvZlxuICAgKiBoYW5kbGVyLiBNb3Zpbmcgb3V0c2lkZSBvZiB0aGlzIHJhbmdlIGltcGxpZXMgYWN0aXZhdGlvbiBvZiBoYW5kbGVyLiBSYW5nZVxuICAgKiBjYW4gYmUgZ2l2ZW4gYXMgYW4gYXJyYXkgb3IgYSBzaW5nbGUgbnVtYmVyLiBJZiByYW5nZSBpcyBzZXQgYXMgYW4gYXJyYXksXG4gICAqIGZpcnN0IHZhbHVlIG11c3QgYmUgbG93ZXIgb3IgZXF1YWwgdG8gMCwgYSB0aGUgc2Vjb25kIG9uZSBoaWdoZXIgb3IgZXF1YWxcbiAgICogdG8gMC4gSWYgb25seSBvbmUgbnVtYmVyIGBwYCBpcyBnaXZlbiBhIHJhbmdlIG9mIGAoLWluZiwgcClgIHdpbGwgYmUgdXNlZFxuICAgKiBpZiBgcGAgaXMgaGlnaGVyIG9yIGVxdWFsIHRvIDAgYW5kIGAoLXAsIGluZilgIG90aGVyd2lzZS5cbiAgICovXG4gIGFjdGl2ZU9mZnNldFg/OiBudW1iZXIgfCBudW1iZXJbXTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgZmluZ2VyIG1vdmVzIG91dHNpZGUgdGhpcyByYW5nZSAoaW4gcG9pbnRzKSBhbG9uZyBZIGF4aXMgYW5kXG4gICAqIGhhbmRsZXIgaGFzbid0IHlldCBhY3RpdmF0ZWQgaXQgd2lsbCBmYWlsIHJlY29nbml6aW5nIHRoZSBnZXN0dXJlLiBSYW5nZVxuICAgKiBjYW4gYmUgZ2l2ZW4gYXMgYW4gYXJyYXkgb3IgYSBzaW5nbGUgbnVtYmVyLiBJZiByYW5nZSBpcyBzZXQgYXMgYW4gYXJyYXksXG4gICAqIGZpcnN0IHZhbHVlIG11c3QgYmUgbG93ZXIgb3IgZXF1YWwgdG8gMCwgYSB0aGUgc2Vjb25kIG9uZSBoaWdoZXIgb3IgZXF1YWxcbiAgICogdG8gMC4gSWYgb25seSBvbmUgbnVtYmVyIGBwYCBpcyBnaXZlbiBhIHJhbmdlIG9mIGAoLWluZiwgcClgIHdpbGwgYmUgdXNlZFxuICAgKiBpZiBgcGAgaXMgaGlnaGVyIG9yIGVxdWFsIHRvIDAgYW5kIGAoLXAsIGluZilgIG90aGVyd2lzZS5cbiAgICovXG4gIGZhaWxPZmZzZXRZPzogbnVtYmVyIHwgbnVtYmVyW107XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIGZpbmdlciBtb3ZlcyBvdXRzaWRlIHRoaXMgcmFuZ2UgKGluIHBvaW50cykgYWxvbmcgWCBheGlzIGFuZFxuICAgKiBoYW5kbGVyIGhhc24ndCB5ZXQgYWN0aXZhdGVkIGl0IHdpbGwgZmFpbCByZWNvZ25pemluZyB0aGUgZ2VzdHVyZS4gUmFuZ2VcbiAgICogY2FuIGJlIGdpdmVuIGFzIGFuIGFycmF5IG9yIGEgc2luZ2xlIG51bWJlci4gSWYgcmFuZ2UgaXMgc2V0IGFzIGFuIGFycmF5LFxuICAgKiBmaXJzdCB2YWx1ZSBtdXN0IGJlIGxvd2VyIG9yIGVxdWFsIHRvIDAsIGEgdGhlIHNlY29uZCBvbmUgaGlnaGVyIG9yIGVxdWFsXG4gICAqIHRvIDAuIElmIG9ubHkgb25lIG51bWJlciBgcGAgaXMgZ2l2ZW4gYSByYW5nZSBvZiBgKC1pbmYsIHApYCB3aWxsIGJlIHVzZWRcbiAgICogaWYgYHBgIGlzIGhpZ2hlciBvciBlcXVhbCB0byAwIGFuZCBgKC1wLCBpbmYpYCBvdGhlcndpc2UuXG4gICAqL1xuICBmYWlsT2Zmc2V0WD86IG51bWJlciB8IG51bWJlcltdO1xufVxuXG5leHBvcnQgdHlwZSBQYW5HZXN0dXJlSGFuZGxlciA9IHR5cGVvZiBQYW5HZXN0dXJlSGFuZGxlcjtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVkZWNsYXJlIC0tIGJhY2t3YXJkIGNvbXBhdGliaWxpdHk7IHNlZSBkZXNjcmlwdGlvbiBvbiB0aGUgdG9wIG9mIGdlc3R1cmVIYW5kbGVyQ29tbW9uLnRzIGZpbGVcbmV4cG9ydCBjb25zdCBQYW5HZXN0dXJlSGFuZGxlciA9IGNyZWF0ZUhhbmRsZXI8XG4gIFBhbkdlc3R1cmVIYW5kbGVyUHJvcHMsXG4gIFBhbkdlc3R1cmVIYW5kbGVyRXZlbnRQYXlsb2FkXG4+KHtcbiAgbmFtZTogJ1Bhbkdlc3R1cmVIYW5kbGVyJyxcbiAgYWxsb3dlZFByb3BzOiBbXG4gICAgLi4uYmFzZUdlc3R1cmVIYW5kbGVyUHJvcHMsXG4gICAgLi4ucGFuR2VzdHVyZUhhbmRsZXJQcm9wcyxcbiAgXSBhcyBjb25zdCxcbiAgY29uZmlnOiB7fSxcbiAgdHJhbnNmb3JtUHJvcHM6IG1hbmFnZVBhblByb3BzLFxuICBjdXN0b21OYXRpdmVQcm9wczogcGFuR2VzdHVyZUhhbmRsZXJDdXN0b21OYXRpdmVQcm9wcyxcbn0pO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMocHJvcHM6IFBhbkdlc3R1cmVIYW5kbGVyUHJvcHMpIHtcbiAgaWYgKFxuICAgIEFycmF5LmlzQXJyYXkocHJvcHMuYWN0aXZlT2Zmc2V0WCkgJiZcbiAgICAocHJvcHMuYWN0aXZlT2Zmc2V0WFswXSA+IDAgfHwgcHJvcHMuYWN0aXZlT2Zmc2V0WFsxXSA8IDApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBGaXJzdCBlbGVtZW50IG9mIGFjdGl2ZU9mZnNldFggc2hvdWxkIGJlIG5lZ2F0aXZlLCBhIHRoZSBzZWNvbmQgb25lIHNob3VsZCBiZSBwb3NpdGl2ZWBcbiAgICApO1xuICB9XG5cbiAgaWYgKFxuICAgIEFycmF5LmlzQXJyYXkocHJvcHMuYWN0aXZlT2Zmc2V0WSkgJiZcbiAgICAocHJvcHMuYWN0aXZlT2Zmc2V0WVswXSA+IDAgfHwgcHJvcHMuYWN0aXZlT2Zmc2V0WVsxXSA8IDApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBGaXJzdCBlbGVtZW50IG9mIGFjdGl2ZU9mZnNldFkgc2hvdWxkIGJlIG5lZ2F0aXZlLCBhIHRoZSBzZWNvbmQgb25lIHNob3VsZCBiZSBwb3NpdGl2ZWBcbiAgICApO1xuICB9XG5cbiAgaWYgKFxuICAgIEFycmF5LmlzQXJyYXkocHJvcHMuZmFpbE9mZnNldFgpICYmXG4gICAgKHByb3BzLmZhaWxPZmZzZXRYWzBdID4gMCB8fCBwcm9wcy5mYWlsT2Zmc2V0WFsxXSA8IDApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBGaXJzdCBlbGVtZW50IG9mIGZhaWxPZmZzZXRYIHNob3VsZCBiZSBuZWdhdGl2ZSwgYSB0aGUgc2Vjb25kIG9uZSBzaG91bGQgYmUgcG9zaXRpdmVgXG4gICAgKTtcbiAgfVxuXG4gIGlmIChcbiAgICBBcnJheS5pc0FycmF5KHByb3BzLmZhaWxPZmZzZXRZKSAmJlxuICAgIChwcm9wcy5mYWlsT2Zmc2V0WVswXSA+IDAgfHwgcHJvcHMuZmFpbE9mZnNldFlbMV0gPCAwKVxuICApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgRmlyc3QgZWxlbWVudCBvZiBmYWlsT2Zmc2V0WSBzaG91bGQgYmUgbmVnYXRpdmUsIGEgdGhlIHNlY29uZCBvbmUgc2hvdWxkIGJlIHBvc2l0aXZlYFxuICAgICk7XG4gIH1cblxuICBpZiAocHJvcHMubWluRGlzdCAmJiAocHJvcHMuZmFpbE9mZnNldFggfHwgcHJvcHMuZmFpbE9mZnNldFkpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEl0IGlzIG5vdCBzdXBwb3J0ZWQgdG8gdXNlIG1pbkRpc3Qgd2l0aCBmYWlsT2Zmc2V0WCBvciBmYWlsT2Zmc2V0WSwgdXNlIGFjdGl2ZU9mZnNldFggYW5kIGFjdGl2ZU9mZnNldFkgaW5zdGVhZGBcbiAgICApO1xuICB9XG5cbiAgaWYgKHByb3BzLm1pbkRpc3QgJiYgKHByb3BzLmFjdGl2ZU9mZnNldFggfHwgcHJvcHMuYWN0aXZlT2Zmc2V0WSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgSXQgaXMgbm90IHN1cHBvcnRlZCB0byB1c2UgbWluRGlzdCB3aXRoIGFjdGl2ZU9mZnNldFggb3IgYWN0aXZlT2Zmc2V0WWBcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMocHJvcHM6IFBhbkdlc3R1cmVIYW5kbGVyUHJvcHMpIHtcbiAgdHlwZSBJbnRlcm5hbFBhbkdIS2V5cyA9XG4gICAgfCAnYWN0aXZlT2Zmc2V0WFN0YXJ0J1xuICAgIHwgJ2FjdGl2ZU9mZnNldFhFbmQnXG4gICAgfCAnZmFpbE9mZnNldFhTdGFydCdcbiAgICB8ICdmYWlsT2Zmc2V0WEVuZCdcbiAgICB8ICdhY3RpdmVPZmZzZXRZU3RhcnQnXG4gICAgfCAnYWN0aXZlT2Zmc2V0WUVuZCdcbiAgICB8ICdmYWlsT2Zmc2V0WVN0YXJ0J1xuICAgIHwgJ2ZhaWxPZmZzZXRZRW5kJztcbiAgdHlwZSBQYW5HZXN0dXJlSGFuZGxlckludGVybmFsUHJvcHMgPSBQYW5HZXN0dXJlSGFuZGxlclByb3BzICZcbiAgICBQYXJ0aWFsPFJlY29yZDxJbnRlcm5hbFBhbkdIS2V5cywgbnVtYmVyPj47XG5cbiAgY29uc3QgcmVzOiBQYW5HZXN0dXJlSGFuZGxlckludGVybmFsUHJvcHMgPSB7IC4uLnByb3BzIH07XG5cbiAgaWYgKHByb3BzLmFjdGl2ZU9mZnNldFggIT09IHVuZGVmaW5lZCkge1xuICAgIGRlbGV0ZSByZXMuYWN0aXZlT2Zmc2V0WDtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wcy5hY3RpdmVPZmZzZXRYKSkge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IHByb3BzLmFjdGl2ZU9mZnNldFhbMF07XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WEVuZCA9IHByb3BzLmFjdGl2ZU9mZnNldFhbMV07XG4gICAgfSBlbHNlIGlmIChwcm9wcy5hY3RpdmVPZmZzZXRYIDwgMCkge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IHByb3BzLmFjdGl2ZU9mZnNldFg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRYRW5kID0gcHJvcHMuYWN0aXZlT2Zmc2V0WDtcbiAgICB9XG4gIH1cblxuICBpZiAocHJvcHMuYWN0aXZlT2Zmc2V0WSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlcy5hY3RpdmVPZmZzZXRZO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByb3BzLmFjdGl2ZU9mZnNldFkpKSB7XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WVN0YXJ0ID0gcHJvcHMuYWN0aXZlT2Zmc2V0WVswXTtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRZRW5kID0gcHJvcHMuYWN0aXZlT2Zmc2V0WVsxXTtcbiAgICB9IGVsc2UgaWYgKHByb3BzLmFjdGl2ZU9mZnNldFkgPCAwKSB7XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WVN0YXJ0ID0gcHJvcHMuYWN0aXZlT2Zmc2V0WTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFlFbmQgPSBwcm9wcy5hY3RpdmVPZmZzZXRZO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9wcy5mYWlsT2Zmc2V0WCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlcy5mYWlsT2Zmc2V0WDtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wcy5mYWlsT2Zmc2V0WCkpIHtcbiAgICAgIHJlcy5mYWlsT2Zmc2V0WFN0YXJ0ID0gcHJvcHMuZmFpbE9mZnNldFhbMF07XG4gICAgICByZXMuZmFpbE9mZnNldFhFbmQgPSBwcm9wcy5mYWlsT2Zmc2V0WFsxXTtcbiAgICB9IGVsc2UgaWYgKHByb3BzLmZhaWxPZmZzZXRYIDwgMCkge1xuICAgICAgcmVzLmZhaWxPZmZzZXRYU3RhcnQgPSBwcm9wcy5mYWlsT2Zmc2V0WDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLmZhaWxPZmZzZXRYRW5kID0gcHJvcHMuZmFpbE9mZnNldFg7XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb3BzLmZhaWxPZmZzZXRZICE9PSB1bmRlZmluZWQpIHtcbiAgICBkZWxldGUgcmVzLmZhaWxPZmZzZXRZO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByb3BzLmZhaWxPZmZzZXRZKSkge1xuICAgICAgcmVzLmZhaWxPZmZzZXRZU3RhcnQgPSBwcm9wcy5mYWlsT2Zmc2V0WVswXTtcbiAgICAgIHJlcy5mYWlsT2Zmc2V0WUVuZCA9IHByb3BzLmZhaWxPZmZzZXRZWzFdO1xuICAgIH0gZWxzZSBpZiAocHJvcHMuZmFpbE9mZnNldFkgPCAwKSB7XG4gICAgICByZXMuZmFpbE9mZnNldFlTdGFydCA9IHByb3BzLmZhaWxPZmZzZXRZO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMuZmFpbE9mZnNldFlFbmQgPSBwcm9wcy5mYWlsT2Zmc2V0WTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFuYWdlUGFuUHJvcHMocHJvcHM6IFBhbkdlc3R1cmVIYW5kbGVyUHJvcHMpIHtcbiAgaWYgKF9fREVWX18pIHtcbiAgICB2YWxpZGF0ZVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMocHJvcHMpO1xuICB9XG4gIHJldHVybiB0cmFuc2Zvcm1QYW5HZXN0dXJlSGFuZGxlclByb3BzKHByb3BzKTtcbn1cbiJdfQ==