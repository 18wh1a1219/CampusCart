{"version":3,"names":["isTablet","useDetectDevice","isIOS","ic_down","require","defaultProps","placeholder","activeColor","data","style","selectedTextProps","DropdownComponent","React","forwardRef","props","currentRef","orientation","onChange","containerStyle","placeholderStyle","selectedTextStyle","inputSearchStyle","iconStyle","labelField","valueField","value","fontFamily","iconColor","searchPlaceholder","search","maxHeight","disable","keyboardAvoiding","renderLeftIcon","renderRightIcon","renderItem","renderInputSearch","onFocus","onBlur","autoScroll","showsVerticalScrollIndicator","dropdownPosition","flatListProps","searchQuery","ref","refList","visible","setVisible","currentValue","setCurrentValue","listData","setListData","position","setPosition","focus","setFocus","keyboardHeight","setKeyboardHeight","Dimensions","get","W","width","H","height","styleContainerVertical","backgroundColor","alignItems","styleHorizontal","marginBottom","alignSelf","open","eventOpen","close","eventClose","font","onKeyboardDidShow","e","_measure","endCoordinates","onKeyboardDidHide","susbcriptionKeyboardDidShow","Keyboard","addListener","susbcriptionKeyboardDidHide","remove","removeListener","getValue","getItem","filter","_","isEqual","length","showOrClose","scrollIndex","onSearch","text","defaultFilterFunction","item","toLowerCase","replace","normalize","key","indexOf","propSearchFunction","labelText","dataSearch","setTimeout","current","index","findIndex","scrollToIndex","animated","onSelect","_renderDropdown","isSelected","styles","dropdown","textItem","icon","tintColor","_renderItem","renderSearch","input","_renderListTop","flex","toString","_renderListBottom","_renderModal","isFull","w","top","bottom","left","styleVertical","isTopPosition","topHeight","keyboardStyle","justifyContent","container","measure","px","py","fx","fy","Math","floor","I18nManager","isRTL"],"sources":["index.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport {\n  Dimensions, FlatList,\n  Image, Keyboard, Modal,\n  Text, TouchableOpacity,\n  TouchableWithoutFeedback,\n  View,\n  ViewStyle,\n  KeyboardEvent,\n  I18nManager\n} from 'react-native';\nimport CInput from '../TextInput';\nimport { useDeviceOrientation } from '../../useDeviceOrientation';\nimport { useDetectDevice } from '../../toolkits';\nimport { styles } from './styles';\nimport { DropdownProps } from './model';\nimport _ from 'lodash';\n\nconst { isTablet, isIOS } = useDetectDevice;\nconst ic_down = require('../../assets/down.png');\n\nconst defaultProps = {\n  placeholder: 'Select item',\n  activeColor: '#F6F7F8',\n  data: [],\n  style: {},\n  selectedTextProps: {}\n}\n\nconst DropdownComponent = React.forwardRef<any, DropdownProps>((props, currentRef) => {\n  const orientation = useDeviceOrientation();\n  const {\n    onChange,\n    style,\n    containerStyle,\n    placeholderStyle,\n    selectedTextStyle,\n    inputSearchStyle,\n    iconStyle,\n    selectedTextProps,\n    data,\n    labelField,\n    valueField,\n    value,\n    activeColor,\n    fontFamily,\n    iconColor = \"gray\",\n    searchPlaceholder,\n    placeholder,\n    search = false,\n    maxHeight = 340,\n    disable = false,\n    keyboardAvoiding = true,\n    renderLeftIcon,\n    renderRightIcon,\n    renderItem,\n    renderInputSearch,\n    onFocus,\n    onBlur,\n    autoScroll = true,\n    showsVerticalScrollIndicator = true,\n    dropdownPosition = 'auto',\n    flatListProps,\n    searchQuery\n  } = props;\n\n  const ref = useRef<View>(null);\n  const refList = useRef<FlatList>(null);\n  const [visible, setVisible] = useState<boolean>(false);\n  const [currentValue, setCurrentValue] = useState<any>(null);\n  const [listData, setListData] = useState<any[]>(data);\n  const [position, setPosition] = useState<any>();\n  const [focus, setFocus] = useState<boolean>(false);\n  const [keyboardHeight, setKeyboardHeight] = useState<number>(0);\n\n  const { width: W, height: H } = Dimensions.get('window');\n  const styleContainerVertical: ViewStyle = { backgroundColor: 'rgba(0,0,0,0.1)', alignItems: 'center' };\n  const styleHorizontal: ViewStyle = { marginBottom: 20, width: W / 2, alignSelf: 'center' };\n\n\n  useImperativeHandle(currentRef, () => {\n    return { open: eventOpen, close: eventClose };\n  });\n\n  useEffect(() => {\n    setListData([...data]);\n  }, [data]);\n\n  const eventOpen = () => {\n    if (!disable) {\n      setVisible(true);\n      if (onFocus) {\n        onFocus();\n      }\n    }\n  }\n\n  const eventClose = () => {\n    if (!disable) {\n      setVisible(false);\n      if (onBlur) {\n        onBlur();\n      }\n    }\n  }\n\n  const font = () => {\n    if (fontFamily) {\n      return {\n        fontFamily: fontFamily\n      }\n    } else {\n      return {}\n    }\n  };\n\n  const onKeyboardDidShow = (e: KeyboardEvent) => {\n    _measure();\n    setKeyboardHeight(e.endCoordinates.height + (isIOS ? 0 : 50));\n  };\n\n  const onKeyboardDidHide = () => {\n    setKeyboardHeight(0);\n  };\n\n  useEffect(() => {\n    const susbcriptionKeyboardDidShow = Keyboard.addListener('keyboardDidShow', onKeyboardDidShow);\n    const susbcriptionKeyboardDidHide = Keyboard.addListener('keyboardDidHide', onKeyboardDidHide);\n\n    return () => {\n      if (typeof susbcriptionKeyboardDidShow?.remove === 'function') {\n        susbcriptionKeyboardDidShow.remove();\n      } else {\n        Keyboard.removeListener('keyboardDidShow', onKeyboardDidShow);\n      }\n\n      if (typeof susbcriptionKeyboardDidHide?.remove === 'function') {\n        susbcriptionKeyboardDidHide.remove();\n      } else {\n        Keyboard.removeListener('keyboardDidHide', onKeyboardDidHide);\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    getValue();\n  }, [value, data]);\n\n  const getValue = () => {\n    const getItem = data.filter(e => _.isEqual(value, _.get(e, valueField)));\n    if (getItem.length > 0) {\n      setCurrentValue((e: any) => e = getItem[0]);\n    } else {\n      setCurrentValue(null);\n    }\n  };\n\n  const showOrClose = () => {\n    if (!disable) {\n      _measure();\n      setVisible(!visible);\n      setListData(data);\n\n      if (!visible) {\n        if (onFocus) {\n          onFocus();\n        }\n      } else {\n        if (onBlur) {\n          onBlur();\n        }\n      }\n    }\n    scrollIndex();\n  };\n\n  const onSearch = (text: string) => {\n    if (text.length > 0) {\n      const defaultFilterFunction = (e: any) => {\n        const item = _.get(e, labelField)?.toLowerCase().replace(' ', '').normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\n        const key = text.toLowerCase().replace(' ', '').normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\n\n        return item.indexOf(key) >= 0\n      }\n\n      const propSearchFunction = (e: any) => {\n        const labelText = _.get(e, labelField);\n\n        return searchQuery?.(text, labelText);\n      }\n\n      const dataSearch = data.filter(searchQuery ? propSearchFunction : defaultFilterFunction);\n      setListData(dataSearch);\n    } else {\n      setListData(data);\n    }\n  };\n\n  const scrollIndex = () => {\n    if (autoScroll && data.length > 0 && listData.length == data.length) {\n      setTimeout(() => {\n        if (refList && refList?.current) {\n          const index = _.findIndex(listData, e => _.isEqual(value, _.get(e, valueField)));\n          if (index > -1 && index <= listData.length - 1) {\n            refList?.current?.scrollToIndex({ index: index, animated: false });\n          }\n        }\n      }, 200);\n    }\n  };\n\n  const onSelect = (item: any) => {\n    onSearch('');\n    setCurrentValue((e: any) => e = item);\n    onChange(item);\n    eventClose();\n  };\n\n  const _renderDropdown = () => {\n    const isSelected = currentValue && _.get(currentValue, valueField);\n    return (\n      <TouchableWithoutFeedback onPress={showOrClose}>\n        <View style={styles.dropdown}>\n          {renderLeftIcon?.()}\n          <Text style={[styles.textItem, isSelected !== null ? selectedTextStyle : placeholderStyle, font()]} {...selectedTextProps}>\n            {isSelected !== null ? _.get(currentValue, labelField) : placeholder}\n          </Text>\n          {renderRightIcon ? renderRightIcon() : <Image source={ic_down} style={[styles.icon, { tintColor: iconColor }, iconStyle]} />}\n        </View>\n      </TouchableWithoutFeedback>\n    )\n  };\n\n  const _renderItem = ({ item, index }: { item: any; index: number }) => {\n    const isSelected = currentValue && _.get(currentValue, valueField);\n    return (\n      <TouchableOpacity key={index} onPress={() => onSelect(item)} style={[_.isEqual(_.get(item, valueField), isSelected) && { backgroundColor: activeColor }]}>\n        {renderItem ? renderItem(item) : <View style={styles.item}>\n          <Text style={[styles.textItem, selectedTextStyle, font()]}>{_.get(item, labelField)}</Text>\n        </View>}\n      </TouchableOpacity>\n    );\n  };\n\n  const renderSearch = () => {\n    if (search) {\n      if (renderInputSearch) {\n        return renderInputSearch((text) => { onSearch(text) });\n      } else {\n        return <CInput\n          style={[styles.input, inputSearchStyle]}\n          inputStyle={[inputSearchStyle, font()]}\n          autoCorrect={false}\n          keyboardType={isIOS ? 'default' : 'visible-password'}\n          placeholder={searchPlaceholder}\n          onChangeText={onSearch}\n          placeholderTextColor=\"gray\"\n          iconStyle={[{ tintColor: iconColor }, iconStyle]}\n          onFocus={() => setFocus(true)}\n          onBlur={() => { setFocus(false) }}\n        />\n      }\n    }\n    return null;\n  }\n\n  const _renderListTop = () => {\n    return <TouchableWithoutFeedback><View style={{ flex: 1 }}>\n      <FlatList\n        {...flatListProps}\n        keyboardShouldPersistTaps=\"handled\"\n        ref={refList}\n        onScrollToIndexFailed={scrollIndex}\n        data={listData}\n        inverted\n        renderItem={_renderItem}\n        keyExtractor={(item, index) => index.toString()}\n        showsVerticalScrollIndicator={showsVerticalScrollIndicator}\n      />\n      {renderSearch()}\n    </View></TouchableWithoutFeedback>\n  };\n\n  const _renderListBottom = () => {\n    return <TouchableWithoutFeedback><View style={{ flex: 1 }}>\n      {renderSearch()}\n      <FlatList\n        {...flatListProps}\n        keyboardShouldPersistTaps=\"handled\"\n        ref={refList}\n        onScrollToIndexFailed={scrollIndex}\n        data={listData}\n        renderItem={_renderItem}\n        keyExtractor={(item, index) => index.toString()}\n        showsVerticalScrollIndicator={showsVerticalScrollIndicator}\n      />\n    </View></TouchableWithoutFeedback>\n  };\n\n  const _renderModal = useCallback(() => {\n    if (visible && position) {\n      const {\n        isFull,\n        w,\n        top,\n        bottom,\n        left,\n        height\n      } = position\n      if (w && top && bottom) {\n        const styleVertical: ViewStyle = { left: left, maxHeight: maxHeight };\n        const isTopPosition = dropdownPosition === 'auto' ? bottom < (isIOS ? 200 : 300) : dropdownPosition === 'top' ? true : false;\n        let topHeight = isTopPosition ? top - height : top;\n\n        let keyboardStyle: ViewStyle = {};\n\n        if (keyboardAvoiding) {\n          if (renderInputSearch) {\n            if (keyboardHeight > 0 && bottom < keyboardHeight + height) {\n              if (isTopPosition) {\n                topHeight = H - keyboardHeight;\n              } else {\n                keyboardStyle = { backgroundColor: 'rgba(0,0,0,0.1)' };\n                topHeight = H - keyboardHeight - 55;\n              }\n            }\n          } else {\n            if (focus && keyboardHeight > 0 && bottom < keyboardHeight + height) {\n              if (isTopPosition) {\n                topHeight = H - keyboardHeight;\n              } else {\n                keyboardStyle = { backgroundColor: 'rgba(0,0,0,0.1)' };\n                topHeight = H - keyboardHeight - 55;\n              }\n            }\n          }\n        }\n\n        return <Modal transparent visible={visible} supportedOrientations={['landscape', 'portrait']} onRequestClose={showOrClose}>\n          <TouchableWithoutFeedback onPress={showOrClose}>\n            <View style={[{ flex: 1 }, isFull && styleContainerVertical, keyboardStyle]}>\n              <View style={{ height: topHeight, width: w, justifyContent: 'flex-end' }}>\n                {isTopPosition && <View style={[{ width: w }, styles.container, containerStyle, isFull ? styleHorizontal : styleVertical]}>\n                  {_renderListTop()}\n                </View>}\n              </View>\n              <View style={{ flex: 1 }}>\n                {!isTopPosition && <View style={[{ width: w }, styles.container, containerStyle, isFull ? styleHorizontal : styleVertical]}>\n                  {_renderListBottom()}\n                </View>}\n              </View>\n            </View>\n          </TouchableWithoutFeedback>\n        </Modal>\n      }\n      return null;\n    }\n    return null;\n  }, [focus, position, visible, keyboardHeight, listData, value]);\n\n  const _measure = () => {\n    if (ref && ref?.current) {\n      ref.current.measure((width, height, px, py, fx, fy) => {\n        const isFull = orientation === 'LANDSCAPE' && !isTablet;\n        const w = Math.floor(px);\n        const top = isFull ? 20 : Math.floor(py) + Math.floor(fy) + 2;\n        const bottom = H - top;\n        const left = I18nManager.isRTL ? W - Math.floor(px) - Math.floor(fx) : Math.floor(fx);\n\n        setPosition({\n          isFull,\n          w,\n          top,\n          bottom: Math.floor(bottom),\n          left,\n          height: Math.floor(py)\n        });\n      })\n    }\n  };\n\n  return (\n    <View style={[{ justifyContent: 'center' }, style]} ref={ref} onLayout={_measure}>\n      {_renderDropdown()}\n      {_renderModal()}\n    </View>\n  );\n});\n\nDropdownComponent.defaultProps = defaultProps;\n\nexport default DropdownComponent;\n\n"],"mappings":"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"}