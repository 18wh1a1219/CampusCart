2782e494d114325bd058ab132647aedc
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _regenerator = _interopRequireDefault2(require("@babel/runtime/regenerator"));

var _extends2 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

var _classCallCheck2 = _interopRequireDefault2(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault2(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault2(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault2(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault2(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault2(require("@babel/runtime/helpers/getPrototypeOf"));

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _theming = require("../../core/theming");

var _Portal = _interopRequireDefault(require("../Portal/Portal"));

var _Surface = _interopRequireDefault(require("../Surface"));

var _MenuItem = _interopRequireDefault(require("./MenuItem"));

var _constants = require("../../constants");

var _addEventListener = require("../../utils/addEventListener");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache(nodeInterop) {
  if (typeof WeakMap !== "function") return null;
  var cacheBabelInterop = new WeakMap();
  var cacheNodeInterop = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {
    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
  })(nodeInterop);
}

function _interopRequireWildcard(obj, nodeInterop) {
  if (!nodeInterop && obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache(nodeInterop);

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

var SCREEN_INDENT = 8;
var ANIMATION_DURATION = 250;

var EASING = _reactNative.Easing.bezier(0.4, 0, 0.2, 1);

var Menu = function (_React$Component) {
  (0, _inherits2.default)(Menu, _React$Component);

  var _super = _createSuper(Menu);

  function Menu() {
    var _this;

    (0, _classCallCheck2.default)(this, Menu);
    _this = _super.apply(this, arguments);

    _defineProperty((0, _assertThisInitialized2.default)(_this), "state", {
      rendered: _this.props.visible,
      top: 0,
      left: 0,
      menuLayout: {
        width: 0,
        height: 0
      },
      anchorLayout: {
        width: 0,
        height: 0
      },
      opacityAnimation: new _reactNative.Animated.Value(0),
      scaleAnimation: new _reactNative.Animated.ValueXY({
        x: 0,
        y: 0
      })
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "anchor", null);

    _defineProperty((0, _assertThisInitialized2.default)(_this), "menu", null);

    _defineProperty((0, _assertThisInitialized2.default)(_this), "backHandlerSubscription", void 0);

    _defineProperty((0, _assertThisInitialized2.default)(_this), "dimensionsSubscription", void 0);

    _defineProperty((0, _assertThisInitialized2.default)(_this), "isCoordinate", function (anchor) {
      return !React.isValidElement(anchor) && typeof (anchor === null || anchor === void 0 ? void 0 : anchor.x) === 'number' && typeof (anchor === null || anchor === void 0 ? void 0 : anchor.y) === 'number';
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "measureMenuLayout", function () {
      return new Promise(function (resolve) {
        if (_this.menu) {
          _this.menu.measureInWindow(function (x, y, width, height) {
            resolve({
              x: x,
              y: y,
              width: width,
              height: height
            });
          });
        }
      });
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "measureAnchorLayout", function () {
      return new Promise(function (resolve) {
        var anchor = _this.props.anchor;

        if (_this.isCoordinate(anchor)) {
          resolve({
            x: anchor.x,
            y: anchor.y,
            width: 0,
            height: 0
          });
          return;
        }

        if (_this.anchor) {
          _this.anchor.measureInWindow(function (x, y, width, height) {
            resolve({
              x: x,
              y: y,
              width: width,
              height: height
            });
          });
        }
      });
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "updateVisibility", function _callee() {
      return _regenerator.default.async(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regenerator.default.awrap(Promise.resolve());

            case 2:
              if (_this.props.visible) {
                _this.show();
              } else {
                _this.hide();
              }

            case 3:
            case "end":
              return _context.stop();
          }
        }
      }, null, null, null, Promise);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "isBrowser", function () {
      return _reactNative.Platform.OS === 'web' && 'document' in global;
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "focusFirstDOMNode", function (el) {
      if (el && _this.isBrowser()) {
        var node = (0, _reactNative.findNodeHandle)(el);
        var focusableNode = node.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
        focusableNode === null || focusableNode === void 0 ? void 0 : focusableNode.focus();
      }
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "handleDismiss", function () {
      if (_this.props.visible) {
        _this.props.onDismiss();
      }

      return true;
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "handleKeypress", function (e) {
      if (e.key === 'Escape') {
        _this.props.onDismiss();
      }
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "attachListeners", function () {
      _this.backHandlerSubscription = (0, _addEventListener.addEventListener)(_reactNative.BackHandler, 'hardwareBackPress', _this.handleDismiss);
      _this.dimensionsSubscription = (0, _addEventListener.addEventListener)(_reactNative.Dimensions, 'change', _this.handleDismiss);
      _this.isBrowser() && document.addEventListener('keyup', _this.handleKeypress);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "removeListeners", function () {
      var _this$backHandlerSubs, _this$dimensionsSubsc;

      (_this$backHandlerSubs = _this.backHandlerSubscription) === null || _this$backHandlerSubs === void 0 ? void 0 : _this$backHandlerSubs.remove();
      (_this$dimensionsSubsc = _this.dimensionsSubscription) === null || _this$dimensionsSubsc === void 0 ? void 0 : _this$dimensionsSubsc.remove();
      _this.isBrowser() && document.removeEventListener('keyup', _this.handleKeypress);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "show", function _callee2() {
      var windowLayout, _await$Promise$all, _await$Promise$all2, menuLayout, anchorLayout;

      return _regenerator.default.async(function _callee2$(_context2) {
        while (1) {
          switch (_context2.prev = _context2.next) {
            case 0:
              windowLayout = _reactNative.Dimensions.get('window');
              _context2.next = 3;
              return _regenerator.default.awrap(Promise.all([_this.measureMenuLayout(), _this.measureAnchorLayout()]));

            case 3:
              _await$Promise$all = _context2.sent;
              _await$Promise$all2 = (0, _slicedToArray2.default)(_await$Promise$all, 2);
              menuLayout = _await$Promise$all2[0];
              anchorLayout = _await$Promise$all2[1];

              if (!(!windowLayout.width || !windowLayout.height || !menuLayout.width || !menuLayout.height || !anchorLayout.width && !_this.isCoordinate(_this.props.anchor) || !anchorLayout.height && !_this.isCoordinate(_this.props.anchor))) {
                _context2.next = 10;
                break;
              }

              requestAnimationFrame(_this.show);
              return _context2.abrupt("return");

            case 10:
              _this.setState(function () {
                return {
                  left: anchorLayout.x,
                  top: anchorLayout.y,
                  anchorLayout: {
                    height: anchorLayout.height,
                    width: anchorLayout.width
                  },
                  menuLayout: {
                    width: menuLayout.width,
                    height: menuLayout.height
                  }
                };
              }, function () {
                _this.attachListeners();

                var animation = _this.props.theme.animation;

                _reactNative.Animated.parallel([_reactNative.Animated.timing(_this.state.scaleAnimation, {
                  toValue: {
                    x: menuLayout.width,
                    y: menuLayout.height
                  },
                  duration: ANIMATION_DURATION * animation.scale,
                  easing: EASING,
                  useNativeDriver: true
                }), _reactNative.Animated.timing(_this.state.opacityAnimation, {
                  toValue: 1,
                  duration: ANIMATION_DURATION * animation.scale,
                  easing: EASING,
                  useNativeDriver: true
                })]).start(function (_ref) {
                  var finished = _ref.finished;

                  if (finished) {
                    _this.focusFirstDOMNode(_this.menu);
                  }
                });
              });

            case 11:
            case "end":
              return _context2.stop();
          }
        }
      }, null, null, null, Promise);
    });

    _defineProperty((0, _assertThisInitialized2.default)(_this), "hide", function () {
      _this.removeListeners();

      var animation = _this.props.theme.animation;

      _reactNative.Animated.timing(_this.state.opacityAnimation, {
        toValue: 0,
        duration: ANIMATION_DURATION * animation.scale,
        easing: EASING,
        useNativeDriver: true
      }).start(function (_ref2) {
        var finished = _ref2.finished;

        if (finished) {
          _this.setState({
            menuLayout: {
              width: 0,
              height: 0
            },
            rendered: false
          });

          _this.state.scaleAnimation.setValue({
            x: 0,
            y: 0
          });

          _this.focusFirstDOMNode(_this.anchor);
        }
      });
    });

    return _this;
  }

  (0, _createClass2.default)(Menu, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      if (prevProps.visible !== this.props.visible) {
        this.updateVisibility();
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.removeListeners();
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          visible = _this$props.visible,
          anchor = _this$props.anchor,
          contentStyle = _this$props.contentStyle,
          style = _this$props.style,
          children = _this$props.children,
          theme = _this$props.theme,
          statusBarHeight = _this$props.statusBarHeight,
          onDismiss = _this$props.onDismiss,
          overlayAccessibilityLabel = _this$props.overlayAccessibilityLabel;
      var _this$state = this.state,
          rendered = _this$state.rendered,
          menuLayout = _this$state.menuLayout,
          anchorLayout = _this$state.anchorLayout,
          opacityAnimation = _this$state.opacityAnimation,
          scaleAnimation = _this$state.scaleAnimation;
      var _this$state2 = this.state,
          left = _this$state2.left,
          top = _this$state2.top;

      var additionalVerticalValue = _reactNative.Platform.select({
        android: statusBarHeight,
        default: 0
      });

      var scaleTransforms = [{
        scaleX: scaleAnimation.x.interpolate({
          inputRange: [0, menuLayout.width],
          outputRange: [0, 1]
        })
      }, {
        scaleY: scaleAnimation.y.interpolate({
          inputRange: [0, menuLayout.height],
          outputRange: [0, 1]
        })
      }];

      var windowLayout = _reactNative.Dimensions.get('window');

      var positionTransforms = [];

      if (left <= windowLayout.width - menuLayout.width - SCREEN_INDENT) {
        positionTransforms.push({
          translateX: scaleAnimation.x.interpolate({
            inputRange: [0, menuLayout.width],
            outputRange: [-(menuLayout.width / 2), 0]
          })
        });

        if (left < SCREEN_INDENT) {
          left = SCREEN_INDENT;
        }
      } else {
        positionTransforms.push({
          translateX: scaleAnimation.x.interpolate({
            inputRange: [0, menuLayout.width],
            outputRange: [menuLayout.width / 2, 0]
          })
        });
        left += anchorLayout.width - menuLayout.width;
        var right = left + menuLayout.width;

        if (right > windowLayout.width - SCREEN_INDENT) {
          left = windowLayout.width - SCREEN_INDENT - menuLayout.width;
        }
      }

      var scrollableMenuHeight = 0;

      if (top >= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue && top <= windowLayout.height - top) {
        scrollableMenuHeight = windowLayout.height - top - SCREEN_INDENT - additionalVerticalValue;
      } else if (top >= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue && top >= windowLayout.height - top && top <= menuLayout.height - anchorLayout.height + SCREEN_INDENT - additionalVerticalValue) {
        scrollableMenuHeight = top + anchorLayout.height - SCREEN_INDENT + additionalVerticalValue;
      }

      scrollableMenuHeight = scrollableMenuHeight > windowLayout.height - 2 * SCREEN_INDENT ? windowLayout.height - 2 * SCREEN_INDENT : scrollableMenuHeight;

      if (top <= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue || top >= windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue && top <= windowLayout.height - top) {
        positionTransforms.push({
          translateY: scaleAnimation.y.interpolate({
            inputRange: [0, menuLayout.height],
            outputRange: [-((scrollableMenuHeight || menuLayout.height) / 2), 0]
          })
        });

        if (top < SCREEN_INDENT) {
          top = SCREEN_INDENT;
        }
      } else {
        positionTransforms.push({
          translateY: scaleAnimation.y.interpolate({
            inputRange: [0, menuLayout.height],
            outputRange: [(scrollableMenuHeight || menuLayout.height) / 2, 0]
          })
        });
        top += anchorLayout.height - (scrollableMenuHeight || menuLayout.height);
        var bottom = top + (scrollableMenuHeight || menuLayout.height) + additionalVerticalValue;

        if (bottom > windowLayout.height - SCREEN_INDENT) {
          top = scrollableMenuHeight === windowLayout.height - 2 * SCREEN_INDENT ? -SCREEN_INDENT * 2 : windowLayout.height - menuLayout.height - SCREEN_INDENT - additionalVerticalValue;
        }
      }

      var shadowMenuContainerStyle = (0, _extends2.default)({
        opacity: opacityAnimation,
        transform: scaleTransforms,
        borderRadius: theme.roundness
      }, scrollableMenuHeight ? {
        height: scrollableMenuHeight
      } : {});
      var positionStyle = (0, _extends2.default)({
        top: this.isCoordinate(anchor) ? top : top + additionalVerticalValue
      }, _reactNative.I18nManager.isRTL ? {
        right: left
      } : {
        left: left
      });
      return React.createElement(_reactNative.View, {
        ref: function ref(_ref3) {
          _this2.anchor = _ref3;
        },
        collapsable: false
      }, this.isCoordinate(anchor) ? null : anchor, rendered ? React.createElement(_Portal.default, null, React.createElement(_reactNative.TouchableWithoutFeedback, {
        accessibilityLabel: overlayAccessibilityLabel,
        accessibilityRole: "button",
        onPress: onDismiss
      }, React.createElement(_reactNative.View, {
        style: _reactNative.StyleSheet.absoluteFill
      })), React.createElement(_reactNative.View, {
        ref: function ref(_ref4) {
          _this2.menu = _ref4;
        },
        collapsable: false,
        accessibilityViewIsModal: visible,
        style: [styles.wrapper, positionStyle, style],
        pointerEvents: visible ? 'box-none' : 'none',
        onAccessibilityEscape: onDismiss
      }, React.createElement(_reactNative.Animated.View, {
        style: {
          transform: positionTransforms
        }
      }, React.createElement(_Surface.default, {
        style: [styles.shadowMenuContainer, shadowMenuContainerStyle, contentStyle]
      }, scrollableMenuHeight && React.createElement(_reactNative.ScrollView, null, children) || React.createElement(React.Fragment, null, children))))) : null);
    }
  }], [{
    key: "getDerivedStateFromProps",
    value: function getDerivedStateFromProps(nextProps, prevState) {
      if (nextProps.visible && !prevState.rendered) {
        return {
          rendered: true
        };
      }

      return null;
    }
  }]);
  return Menu;
}(React.Component);

_defineProperty(Menu, "Item", _MenuItem.default);

_defineProperty(Menu, "defaultProps", {
  statusBarHeight: _constants.APPROX_STATUSBAR_HEIGHT,
  overlayAccessibilityLabel: 'Close menu'
});

var styles = _reactNative.StyleSheet.create({
  wrapper: {
    position: 'absolute'
  },
  shadowMenuContainer: {
    opacity: 0,
    paddingVertical: 8,
    elevation: 8
  }
});

var _default = (0, _theming.withTheme)(Menu);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OUUsb0JBQUN5Rix1QkFBRCxRQUFhNUIsUUFBYixDQURBaUIsSUFFSTlFLG9CQUFDQSxLQUFELENBQU8wRyxRQUFQLFFBQWlCN0MsUUFBakIsQ0FYUixDQURGLENBVkYsQ0FSRixDQURPLEdBb0NMLElBM0NOLENBREY7SUErQ0Q7OztXQTliOEIsa0NBQUM4QyxTQUFELEVBQW1CQyxTQUFuQixFQUFxQztNQUNsRSxJQUFJRCxTQUFTLENBQUMxSCxPQUFWMEgsSUFBcUIsQ0FBQ0MsU0FBUyxDQUFDN0gsUUFBcEMsRUFBOEM7UUFDNUMsT0FBTztVQUFFQSxRQUFRLEVBQUU7UUFBWixDQUFQO01BQ0Q7O01BRUQsT0FBTyxJQUFQO0lBQ0Q7OztFQWZnQmlCLEtBQUssQ0FBQzZHLFM7O2dCQUFuQmhJLE0sUUFFVWlJOztnQkFGVmpJLE0sZ0JBSWtCO0VBQ3BCaUYsZUFBZSxFQUFFaUQsa0NBREc7RUFFcEJoRCx5QkFBeUIsRUFBRTtBQUZQOztBQXNjeEIsSUFBTW9DLE1BQU0sR0FBR0gsd0JBQVdnQixNQUFYaEIsQ0FBa0I7RUFDL0JJLE9BQU8sRUFBRTtJQUNQYSxRQUFRLEVBQUU7RUFESCxDQURzQjtFQUkvQlIsbUJBQW1CLEVBQUU7SUFDbkJ2QixPQUFPLEVBQUUsQ0FEVTtJQUVuQmdDLGVBQWUsRUFBRSxDQUZFO0lBR25CQyxTQUFTLEVBQUU7RUFIUTtBQUpVLENBQWxCbkIsQ0FBZjs7ZUFXZSx3QkFBVW5ILElBQVYiLCJuYW1lcyI6WyJTQ1JFRU5fSU5ERU5UIiwiQU5JTUFUSU9OX0RVUkFUSU9OIiwiRUFTSU5HIiwiRWFzaW5nIiwiYmV6aWVyIiwiTWVudSIsIl9kZWZpbmVQcm9wZXJ0eSIsInJlbmRlcmVkIiwicHJvcHMiLCJ2aXNpYmxlIiwidG9wIiwibGVmdCIsIm1lbnVMYXlvdXQiLCJ3aWR0aCIsImhlaWdodCIsImFuY2hvckxheW91dCIsIm9wYWNpdHlBbmltYXRpb24iLCJBbmltYXRlZCIsIlZhbHVlIiwic2NhbGVBbmltYXRpb24iLCJWYWx1ZVhZIiwieCIsInkiLCJhbmNob3IiLCJSZWFjdCIsImlzVmFsaWRFbGVtZW50IiwiUHJvbWlzZSIsInJlc29sdmUiLCJtZW51IiwibWVhc3VyZUluV2luZG93IiwiaXNDb29yZGluYXRlIiwic2hvdyIsImhpZGUiLCJQbGF0Zm9ybSIsIk9TIiwiZ2xvYmFsIiwiZWwiLCJpc0Jyb3dzZXIiLCJub2RlIiwiZm9jdXNhYmxlTm9kZSIsInF1ZXJ5U2VsZWN0b3IiLCJmb2N1cyIsIm9uRGlzbWlzcyIsImUiLCJrZXkiLCJiYWNrSGFuZGxlclN1YnNjcmlwdGlvbiIsIkJhY2tIYW5kbGVyIiwiaGFuZGxlRGlzbWlzcyIsImRpbWVuc2lvbnNTdWJzY3JpcHRpb24iLCJEaW1lbnNpb25zIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlS2V5cHJlc3MiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2luZG93TGF5b3V0IiwiZ2V0IiwiYWxsIiwibWVhc3VyZU1lbnVMYXlvdXQiLCJtZWFzdXJlQW5jaG9yTGF5b3V0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2V0U3RhdGUiLCJhdHRhY2hMaXN0ZW5lcnMiLCJhbmltYXRpb24iLCJ0aGVtZSIsInBhcmFsbGVsIiwidGltaW5nIiwic3RhdGUiLCJ0b1ZhbHVlIiwiZHVyYXRpb24iLCJzY2FsZSIsImVhc2luZyIsInVzZU5hdGl2ZURyaXZlciIsInN0YXJ0IiwiZmluaXNoZWQiLCJmb2N1c0ZpcnN0RE9NTm9kZSIsInJlbW92ZUxpc3RlbmVycyIsInNldFZhbHVlIiwiY29tcG9uZW50RGlkVXBkYXRlIiwicHJldlByb3BzIiwidXBkYXRlVmlzaWJpbGl0eSIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicmVuZGVyIiwiY29udGVudFN0eWxlIiwic3R5bGUiLCJjaGlsZHJlbiIsInN0YXR1c0JhckhlaWdodCIsIm92ZXJsYXlBY2Nlc3NpYmlsaXR5TGFiZWwiLCJhZGRpdGlvbmFsVmVydGljYWxWYWx1ZSIsInNlbGVjdCIsImFuZHJvaWQiLCJkZWZhdWx0Iiwic2NhbGVUcmFuc2Zvcm1zIiwic2NhbGVYIiwiaW50ZXJwb2xhdGUiLCJpbnB1dFJhbmdlIiwib3V0cHV0UmFuZ2UiLCJzY2FsZVkiLCJwb3NpdGlvblRyYW5zZm9ybXMiLCJwdXNoIiwidHJhbnNsYXRlWCIsInJpZ2h0Iiwic2Nyb2xsYWJsZU1lbnVIZWlnaHQiLCJ0cmFuc2xhdGVZIiwiYm90dG9tIiwic2hhZG93TWVudUNvbnRhaW5lclN0eWxlIiwib3BhY2l0eSIsInRyYW5zZm9ybSIsImJvcmRlclJhZGl1cyIsInJvdW5kbmVzcyIsInBvc2l0aW9uU3R5bGUiLCJJMThuTWFuYWdlciIsImlzUlRMIiwiX3JlYWN0TmF0aXZlIiwicmVmIiwiY29sbGFwc2FibGUiLCJfUG9ydGFsIiwiYWNjZXNzaWJpbGl0eUxhYmVsIiwiYWNjZXNzaWJpbGl0eVJvbGUiLCJvblByZXNzIiwiU3R5bGVTaGVldCIsImFic29sdXRlRmlsbCIsImFjY2Vzc2liaWxpdHlWaWV3SXNNb2RhbCIsInN0eWxlcyIsIndyYXBwZXIiLCJwb2ludGVyRXZlbnRzIiwib25BY2Nlc3NpYmlsaXR5RXNjYXBlIiwiVmlldyIsIl9TdXJmYWNlIiwic2hhZG93TWVudUNvbnRhaW5lciIsIkZyYWdtZW50IiwibmV4dFByb3BzIiwicHJldlN0YXRlIiwiQ29tcG9uZW50IiwiTWVudUl0ZW0iLCJBUFBST1hfU1RBVFVTQkFSX0hFSUdIVCIsImNyZWF0ZSIsInBvc2l0aW9uIiwicGFkZGluZ1ZlcnRpY2FsIiwiZWxldmF0aW9uIl0sInNvdXJjZXMiOlsiTWVudS50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgUGxhdGZvcm0sXG4gIFN0eWxlUHJvcCxcbiAgU3R5bGVTaGVldCxcbiAgQW5pbWF0ZWQsXG4gIEJhY2tIYW5kbGVyLFxuICBEaW1lbnNpb25zLFxuICBFYXNpbmcsXG4gIEkxOG5NYW5hZ2VyLFxuICBMYXlvdXRSZWN0YW5nbGUsXG4gIFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayxcbiAgVmlldyxcbiAgVmlld1N0eWxlLFxuICBTY3JvbGxWaWV3LFxuICBmaW5kTm9kZUhhbmRsZSxcbiAgTmF0aXZlRXZlbnRTdWJzY3JpcHRpb24sXG59IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5cbmltcG9ydCB7IHdpdGhUaGVtZSB9IGZyb20gJy4uLy4uL2NvcmUvdGhlbWluZyc7XG5pbXBvcnQgdHlwZSB7ICRPbWl0IH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuaW1wb3J0IFBvcnRhbCBmcm9tICcuLi9Qb3J0YWwvUG9ydGFsJztcbmltcG9ydCBTdXJmYWNlIGZyb20gJy4uL1N1cmZhY2UnO1xuaW1wb3J0IE1lbnVJdGVtIGZyb20gJy4vTWVudUl0ZW0nO1xuaW1wb3J0IHsgQVBQUk9YX1NUQVRVU0JBUl9IRUlHSFQgfSBmcm9tICcuLi8uLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgYWRkRXZlbnRMaXN0ZW5lciB9IGZyb20gJy4uLy4uL3V0aWxzL2FkZEV2ZW50TGlzdGVuZXInO1xuXG50eXBlIFByb3BzID0ge1xuICAvKipcbiAgICogV2hldGhlciB0aGUgTWVudSBpcyBjdXJyZW50bHkgdmlzaWJsZS5cbiAgICovXG4gIHZpc2libGU6IGJvb2xlYW47XG4gIC8qKlxuICAgKiBUaGUgYW5jaG9yIHRvIG9wZW4gdGhlIG1lbnUgZnJvbS4gSW4gbW9zdCBjYXNlcywgaXQgd2lsbCBiZSBhIGJ1dHRvbiB0aGF0IG9wZW5zIHRoZSBtZW51LlxuICAgKi9cbiAgYW5jaG9yOiBSZWFjdC5SZWFjdE5vZGUgfCB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH07XG4gIC8qKlxuICAgKiBFeHRyYSBtYXJnaW4gdG8gYWRkIGF0IHRoZSB0b3Agb2YgdGhlIG1lbnUgdG8gYWNjb3VudCBmb3IgdHJhbnNsdWNlbnQgc3RhdHVzIGJhciBvbiBBbmRyb2lkLlxuICAgKiBJZiB5b3UgYXJlIHVzaW5nIEV4cG8sIHdlIGFzc3VtZSB0cmFuc2x1Y2VudCBzdGF0dXMgYmFyIGFuZCBzZXQgYSBoZWlnaHQgZm9yIHN0YXR1cyBiYXIgYXV0b21hdGljYWxseS5cbiAgICogUGFzcyBgMGAgb3IgYSBjdXN0b20gdmFsdWUgdG8gYW5kIGN1c3RvbWl6ZSBpdC5cbiAgICogVGhpcyBpcyBhdXRvbWF0aWNhbGx5IGhhbmRsZWQgb24gaU9TLlxuICAgKi9cbiAgc3RhdHVzQmFySGVpZ2h0PzogbnVtYmVyO1xuICAvKipcbiAgICogQ2FsbGJhY2sgY2FsbGVkIHdoZW4gTWVudSBpcyBkaXNtaXNzZWQuIFRoZSBgdmlzaWJsZWAgcHJvcCBuZWVkcyB0byBiZSB1cGRhdGVkIHdoZW4gdGhpcyBpcyBjYWxsZWQuXG4gICAqL1xuICBvbkRpc21pc3M6ICgpID0+IHZvaWQ7XG4gIC8qKlxuICAgKiBBY2Nlc3NpYmlsaXR5IGxhYmVsIGZvciB0aGUgb3ZlcmxheS4gVGhpcyBpcyByZWFkIGJ5IHRoZSBzY3JlZW4gcmVhZGVyIHdoZW4gdGhlIHVzZXIgdGFwcyBvdXRzaWRlIHRoZSBtZW51LlxuICAgKi9cbiAgb3ZlcmxheUFjY2Vzc2liaWxpdHlMYWJlbD86IHN0cmluZztcbiAgLyoqXG4gICAqIENvbnRlbnQgb2YgdGhlIGBNZW51YC5cbiAgICovXG4gIGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7XG4gIC8qKlxuICAgKiBTdHlsZSBvZiBtZW51J3MgaW5uZXIgY29udGVudC5cbiAgICovXG4gIGNvbnRlbnRTdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICBzdHlsZT86IFN0eWxlUHJvcDxWaWV3U3R5bGU+O1xuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqL1xuICB0aGVtZTogUmVhY3ROYXRpdmVQYXBlci5UaGVtZTtcbn07XG5cbnR5cGUgTGF5b3V0ID0gJE9taXQ8JE9taXQ8TGF5b3V0UmVjdGFuZ2xlLCAneCc+LCAneSc+O1xuXG50eXBlIFN0YXRlID0ge1xuICByZW5kZXJlZDogYm9vbGVhbjtcbiAgdG9wOiBudW1iZXI7XG4gIGxlZnQ6IG51bWJlcjtcbiAgbWVudUxheW91dDogTGF5b3V0O1xuICBhbmNob3JMYXlvdXQ6IExheW91dDtcbiAgb3BhY2l0eUFuaW1hdGlvbjogQW5pbWF0ZWQuVmFsdWU7XG4gIHNjYWxlQW5pbWF0aW9uOiBBbmltYXRlZC5WYWx1ZVhZO1xufTtcblxuLy8gTWluaW11bSBwYWRkaW5nIGJldHdlZW4gdGhlIGVkZ2Ugb2YgdGhlIHNjcmVlbiBhbmQgdGhlIG1lbnVcbmNvbnN0IFNDUkVFTl9JTkRFTlQgPSA4O1xuLy8gRnJvbSBodHRwczovL21hdGVyaWFsLmlvL2Rlc2lnbi9tb3Rpb24vc3BlZWQuaHRtbCNkdXJhdGlvblxuY29uc3QgQU5JTUFUSU9OX0RVUkFUSU9OID0gMjUwO1xuLy8gRnJvbSB0aGUgJ1N0YW5kYXJkIGVhc2luZycgc2VjdGlvbiBvZiBodHRwczovL21hdGVyaWFsLmlvL2Rlc2lnbi9tb3Rpb24vc3BlZWQuaHRtbCNlYXNpbmdcbmNvbnN0IEVBU0lORyA9IEVhc2luZy5iZXppZXIoMC40LCAwLCAwLjIsIDEpO1xuXG4vKipcbiAqIE1lbnVzIGRpc3BsYXkgYSBsaXN0IG9mIGNob2ljZXMgb24gdGVtcG9yYXJ5IGVsZXZhdGVkIHN1cmZhY2VzLiBUaGVpciBwbGFjZW1lbnQgdmFyaWVzIGJhc2VkIG9uIHRoZSBlbGVtZW50IHRoYXQgb3BlbnMgdGhlbS5cbiAqXG4gKiAgPGRpdiBjbGFzcz1cInNjcmVlbnNob3RzXCI+XG4gKiAgIDxpbWcgY2xhc3M9XCJtZWRpdW1cIiBzcmM9XCJzY3JlZW5zaG90cy9tZW51LTEucG5nXCIgLz5cbiAqICAgPGltZyBjbGFzcz1cIm1lZGl1bVwiIHNyYz1cInNjcmVlbnNob3RzL21lbnUtMi5wbmdcIiAvPlxuICogPC9kaXY+XG4gKlxuICogIyMgVXNhZ2VcbiAqIGBgYGpzXG4gKiBpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG4gKiBpbXBvcnQgeyBWaWV3IH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbiAqIGltcG9ydCB7IEJ1dHRvbiwgTWVudSwgRGl2aWRlciwgUHJvdmlkZXIgfSBmcm9tICdyZWFjdC1uYXRpdmUtcGFwZXInO1xuICpcbiAqIGNvbnN0IE15Q29tcG9uZW50ID0gKCkgPT4ge1xuICogICBjb25zdCBbdmlzaWJsZSwgc2V0VmlzaWJsZV0gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7XG4gKlxuICogICBjb25zdCBvcGVuTWVudSA9ICgpID0+IHNldFZpc2libGUodHJ1ZSk7XG4gKlxuICogICBjb25zdCBjbG9zZU1lbnUgPSAoKSA9PiBzZXRWaXNpYmxlKGZhbHNlKTtcbiAqXG4gKiAgIHJldHVybiAoXG4gKiAgICAgPFByb3ZpZGVyPlxuICogICAgICAgPFZpZXdcbiAqICAgICAgICAgc3R5bGU9e3tcbiAqICAgICAgICAgICBwYWRkaW5nVG9wOiA1MCxcbiAqICAgICAgICAgICBmbGV4RGlyZWN0aW9uOiAncm93JyxcbiAqICAgICAgICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gKiAgICAgICAgIH19PlxuICogICAgICAgICA8TWVudVxuICogICAgICAgICAgIHZpc2libGU9e3Zpc2libGV9XG4gKiAgICAgICAgICAgb25EaXNtaXNzPXtjbG9zZU1lbnV9XG4gKiAgICAgICAgICAgYW5jaG9yPXs8QnV0dG9uIG9uUHJlc3M9e29wZW5NZW51fT5TaG93IG1lbnU8L0J1dHRvbj59PlxuICogICAgICAgICAgIDxNZW51Lkl0ZW0gb25QcmVzcz17KCkgPT4ge319IHRpdGxlPVwiSXRlbSAxXCIgLz5cbiAqICAgICAgICAgICA8TWVudS5JdGVtIG9uUHJlc3M9eygpID0+IHt9fSB0aXRsZT1cIkl0ZW0gMlwiIC8+XG4gKiAgICAgICAgICAgPERpdmlkZXIgLz5cbiAqICAgICAgICAgICA8TWVudS5JdGVtIG9uUHJlc3M9eygpID0+IHt9fSB0aXRsZT1cIkl0ZW0gM1wiIC8+XG4gKiAgICAgICAgIDwvTWVudT5cbiAqICAgICAgIDwvVmlldz5cbiAqICAgICA8L1Byb3ZpZGVyPlxuICogICApO1xuICogfTtcbiAqXG4gKiBleHBvcnQgZGVmYXVsdCBNeUNvbXBvbmVudDtcbiAqIGBgYFxuICovXG5jbGFzcyBNZW51IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICAvLyBAY29tcG9uZW50IC4vTWVudUl0ZW0udHN4XG4gIHN0YXRpYyBJdGVtID0gTWVudUl0ZW07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBzdGF0dXNCYXJIZWlnaHQ6IEFQUFJPWF9TVEFUVVNCQVJfSEVJR0hULFxuICAgIG92ZXJsYXlBY2Nlc3NpYmlsaXR5TGFiZWw6ICdDbG9zZSBtZW51JyxcbiAgfTtcblxuICBzdGF0aWMgZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzKG5leHRQcm9wczogUHJvcHMsIHByZXZTdGF0ZTogU3RhdGUpIHtcbiAgICBpZiAobmV4dFByb3BzLnZpc2libGUgJiYgIXByZXZTdGF0ZS5yZW5kZXJlZCkge1xuICAgICAgcmV0dXJuIHsgcmVuZGVyZWQ6IHRydWUgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHN0YXRlID0ge1xuICAgIHJlbmRlcmVkOiB0aGlzLnByb3BzLnZpc2libGUsXG4gICAgdG9wOiAwLFxuICAgIGxlZnQ6IDAsXG4gICAgbWVudUxheW91dDogeyB3aWR0aDogMCwgaGVpZ2h0OiAwIH0sXG4gICAgYW5jaG9yTGF5b3V0OiB7IHdpZHRoOiAwLCBoZWlnaHQ6IDAgfSxcbiAgICBvcGFjaXR5QW5pbWF0aW9uOiBuZXcgQW5pbWF0ZWQuVmFsdWUoMCksXG4gICAgc2NhbGVBbmltYXRpb246IG5ldyBBbmltYXRlZC5WYWx1ZVhZKHsgeDogMCwgeTogMCB9KSxcbiAgfTtcblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzOiBQcm9wcykge1xuICAgIGlmIChwcmV2UHJvcHMudmlzaWJsZSAhPT0gdGhpcy5wcm9wcy52aXNpYmxlKSB7XG4gICAgICB0aGlzLnVwZGF0ZVZpc2liaWxpdHkoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVycygpO1xuICB9XG5cbiAgcHJpdmF0ZSBhbmNob3I/OiBWaWV3IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbWVudT86IFZpZXcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBiYWNrSGFuZGxlclN1YnNjcmlwdGlvbjogTmF0aXZlRXZlbnRTdWJzY3JpcHRpb24gfCB1bmRlZmluZWQ7XG4gIHByaXZhdGUgZGltZW5zaW9uc1N1YnNjcmlwdGlvbjogTmF0aXZlRXZlbnRTdWJzY3JpcHRpb24gfCB1bmRlZmluZWQ7XG5cbiAgcHJpdmF0ZSBpc0Nvb3JkaW5hdGUgPSAoYW5jaG9yOiBhbnkpOiBhbmNob3IgaXMgeyB4OiBudW1iZXI7IHk6IG51bWJlciB9ID0+XG4gICAgIVJlYWN0LmlzVmFsaWRFbGVtZW50KGFuY2hvcikgJiZcbiAgICB0eXBlb2YgYW5jaG9yPy54ID09PSAnbnVtYmVyJyAmJlxuICAgIHR5cGVvZiBhbmNob3I/LnkgPT09ICdudW1iZXInO1xuXG4gIHByaXZhdGUgbWVhc3VyZU1lbnVMYXlvdXQgPSAoKSA9PlxuICAgIG5ldyBQcm9taXNlPExheW91dFJlY3RhbmdsZT4oKHJlc29sdmUpID0+IHtcbiAgICAgIGlmICh0aGlzLm1lbnUpIHtcbiAgICAgICAgdGhpcy5tZW51Lm1lYXN1cmVJbldpbmRvdygoeCwgeSwgd2lkdGgsIGhlaWdodCkgPT4ge1xuICAgICAgICAgIHJlc29sdmUoeyB4LCB5LCB3aWR0aCwgaGVpZ2h0IH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICBwcml2YXRlIG1lYXN1cmVBbmNob3JMYXlvdXQgPSAoKSA9PlxuICAgIG5ldyBQcm9taXNlPExheW91dFJlY3RhbmdsZT4oKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IHsgYW5jaG9yIH0gPSB0aGlzLnByb3BzO1xuICAgICAgaWYgKHRoaXMuaXNDb29yZGluYXRlKGFuY2hvcikpIHtcbiAgICAgICAgcmVzb2x2ZSh7IHg6IGFuY2hvci54LCB5OiBhbmNob3IueSwgd2lkdGg6IDAsIGhlaWdodDogMCB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5hbmNob3IpIHtcbiAgICAgICAgdGhpcy5hbmNob3IubWVhc3VyZUluV2luZG93KCh4LCB5LCB3aWR0aCwgaGVpZ2h0KSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZSh7IHgsIHksIHdpZHRoLCBoZWlnaHQgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIHByaXZhdGUgdXBkYXRlVmlzaWJpbGl0eSA9IGFzeW5jICgpID0+IHtcbiAgICAvLyBNZW51IGlzIHJlbmRlcmVkIGluIFBvcnRhbCwgd2hpY2ggdXBkYXRlcyBpdGVtcyBhc3luY2hyb25vdXNseVxuICAgIC8vIFdlIG5lZWQgdG8gZG8gdGhlIHNhbWUgaGVyZSBzbyB0aGF0IHRoZSByZWYgaXMgdXAtdG8tZGF0ZVxuICAgIGF3YWl0IFByb21pc2UucmVzb2x2ZSgpO1xuXG4gICAgaWYgKHRoaXMucHJvcHMudmlzaWJsZSkge1xuICAgICAgdGhpcy5zaG93KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGlkZSgpO1xuICAgIH1cbiAgfTtcblxuICBwcml2YXRlIGlzQnJvd3NlciA9ICgpID0+IFBsYXRmb3JtLk9TID09PSAnd2ViJyAmJiAnZG9jdW1lbnQnIGluIGdsb2JhbDtcblxuICBwcml2YXRlIGZvY3VzRmlyc3RET01Ob2RlID0gKGVsOiBWaWV3IHwgbnVsbCB8IHVuZGVmaW5lZCkgPT4ge1xuICAgIGlmIChlbCAmJiB0aGlzLmlzQnJvd3NlcigpKSB7XG4gICAgICAvLyBXaGVuIGluIHRoZSBicm93c2VyLCB3ZSB3YW50IHRvIGZvY3VzIHRoZSBmaXJzdCBmb2N1c2FibGUgaXRlbSBvbiB0b2dnbGVcbiAgICAgIC8vIEZvciBleGFtcGxlLCB3aGVuIG1lbnUgaXMgc2hvd24sIGZvY3VzIHRoZSBmaXJzdCBpdGVtIGluIHRoZSBtZW51XG4gICAgICAvLyBBbmQgd2hlbiBtZW51IGlzIGRpc21pc3NlZCwgc2VuZCBmb2N1cyBiYWNrIHRvIHRoZSBidXR0b24gdG8gcmVzdW1lIHRhYmJpbmdcbiAgICAgIGNvbnN0IG5vZGU6IGFueSA9IGZpbmROb2RlSGFuZGxlKGVsKTtcbiAgICAgIGNvbnN0IGZvY3VzYWJsZU5vZGUgPSBub2RlLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgIC8vIFRoaXMgaXMgYSByb3VnaCBsaXN0IG9mIHNlbGVjdG9ycyB0aGF0IGNhbiBiZSBmb2N1c2VkXG4gICAgICAgICdidXR0b24sIFtocmVmXSwgaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEsIFt0YWJpbmRleF06bm90KFt0YWJpbmRleD1cIi0xXCJdKSdcbiAgICAgICk7XG5cbiAgICAgIGZvY3VzYWJsZU5vZGU/LmZvY3VzKCk7XG4gICAgfVxuICB9O1xuXG4gIHByaXZhdGUgaGFuZGxlRGlzbWlzcyA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5wcm9wcy52aXNpYmxlKSB7XG4gICAgICB0aGlzLnByb3BzLm9uRGlzbWlzcygpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICBwcml2YXRlIGhhbmRsZUtleXByZXNzID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICB0aGlzLnByb3BzLm9uRGlzbWlzcygpO1xuICAgIH1cbiAgfTtcblxuICBwcml2YXRlIGF0dGFjaExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLmJhY2tIYW5kbGVyU3Vic2NyaXB0aW9uID0gYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIEJhY2tIYW5kbGVyLFxuICAgICAgJ2hhcmR3YXJlQmFja1ByZXNzJyxcbiAgICAgIHRoaXMuaGFuZGxlRGlzbWlzc1xuICAgICk7XG4gICAgdGhpcy5kaW1lbnNpb25zU3Vic2NyaXB0aW9uID0gYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIERpbWVuc2lvbnMsXG4gICAgICAnY2hhbmdlJyxcbiAgICAgIHRoaXMuaGFuZGxlRGlzbWlzc1xuICAgICk7XG4gICAgdGhpcy5pc0Jyb3dzZXIoKSAmJiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuaGFuZGxlS2V5cHJlc3MpO1xuICB9O1xuXG4gIHByaXZhdGUgcmVtb3ZlTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuYmFja0hhbmRsZXJTdWJzY3JpcHRpb24/LnJlbW92ZSgpO1xuICAgIHRoaXMuZGltZW5zaW9uc1N1YnNjcmlwdGlvbj8ucmVtb3ZlKCk7XG4gICAgdGhpcy5pc0Jyb3dzZXIoKSAmJlxuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLmhhbmRsZUtleXByZXNzKTtcbiAgfTtcblxuICBwcml2YXRlIHNob3cgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgd2luZG93TGF5b3V0ID0gRGltZW5zaW9ucy5nZXQoJ3dpbmRvdycpO1xuICAgIGNvbnN0IFttZW51TGF5b3V0LCBhbmNob3JMYXlvdXRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5tZWFzdXJlTWVudUxheW91dCgpLFxuICAgICAgdGhpcy5tZWFzdXJlQW5jaG9yTGF5b3V0KCksXG4gICAgXSk7XG5cbiAgICAvLyBXaGVuIHZpc2libGUgaXMgdHJ1ZSBmb3IgZmlyc3QgcmVuZGVyXG4gICAgLy8gbmF0aXZlIHZpZXdzIGNhbiBiZSBzdGlsbCBub3QgcmVuZGVyZWQgYW5kXG4gICAgLy8gbWVhc3VyZU1lbnVMYXlvdXQvbWVhc3VyZUFuY2hvckxheW91dCBmdW5jdGlvbnNcbiAgICAvLyByZXR1cm4gd3JvbmcgdmFsdWVzIGUuZyB7IHg6MCwgeTogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9XG4gICAgLy8gc28gd2UgaGF2ZSB0byB3YWl0IHVudGlsIHZpZXdzIGFyZSByZWFkeVxuICAgIC8vIGFuZCByZXJ1biB0aGlzIGZ1bmN0aW9uIHRvIHNob3cgbWVudVxuICAgIGlmIChcbiAgICAgICF3aW5kb3dMYXlvdXQud2lkdGggfHxcbiAgICAgICF3aW5kb3dMYXlvdXQuaGVpZ2h0IHx8XG4gICAgICAhbWVudUxheW91dC53aWR0aCB8fFxuICAgICAgIW1lbnVMYXlvdXQuaGVpZ2h0IHx8XG4gICAgICAoIWFuY2hvckxheW91dC53aWR0aCAmJiAhdGhpcy5pc0Nvb3JkaW5hdGUodGhpcy5wcm9wcy5hbmNob3IpKSB8fFxuICAgICAgKCFhbmNob3JMYXlvdXQuaGVpZ2h0ICYmICF0aGlzLmlzQ29vcmRpbmF0ZSh0aGlzLnByb3BzLmFuY2hvcikpXG4gICAgKSB7XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5zaG93KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKFxuICAgICAgKCkgPT4gKHtcbiAgICAgICAgbGVmdDogYW5jaG9yTGF5b3V0LngsXG4gICAgICAgIHRvcDogYW5jaG9yTGF5b3V0LnksXG4gICAgICAgIGFuY2hvckxheW91dDoge1xuICAgICAgICAgIGhlaWdodDogYW5jaG9yTGF5b3V0LmhlaWdodCxcbiAgICAgICAgICB3aWR0aDogYW5jaG9yTGF5b3V0LndpZHRoLFxuICAgICAgICB9LFxuICAgICAgICBtZW51TGF5b3V0OiB7XG4gICAgICAgICAgd2lkdGg6IG1lbnVMYXlvdXQud2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiBtZW51TGF5b3V0LmhlaWdodCxcbiAgICAgICAgfSxcbiAgICAgIH0pLFxuICAgICAgKCkgPT4ge1xuICAgICAgICB0aGlzLmF0dGFjaExpc3RlbmVycygpO1xuXG4gICAgICAgIGNvbnN0IHsgYW5pbWF0aW9uIH0gPSB0aGlzLnByb3BzLnRoZW1lO1xuICAgICAgICBBbmltYXRlZC5wYXJhbGxlbChbXG4gICAgICAgICAgQW5pbWF0ZWQudGltaW5nKHRoaXMuc3RhdGUuc2NhbGVBbmltYXRpb24sIHtcbiAgICAgICAgICAgIHRvVmFsdWU6IHsgeDogbWVudUxheW91dC53aWR0aCwgeTogbWVudUxheW91dC5oZWlnaHQgfSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiBBTklNQVRJT05fRFVSQVRJT04gKiBhbmltYXRpb24uc2NhbGUsXG4gICAgICAgICAgICBlYXNpbmc6IEVBU0lORyxcbiAgICAgICAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBBbmltYXRlZC50aW1pbmcodGhpcy5zdGF0ZS5vcGFjaXR5QW5pbWF0aW9uLCB7XG4gICAgICAgICAgICB0b1ZhbHVlOiAxLFxuICAgICAgICAgICAgZHVyYXRpb246IEFOSU1BVElPTl9EVVJBVElPTiAqIGFuaW1hdGlvbi5zY2FsZSxcbiAgICAgICAgICAgIGVhc2luZzogRUFTSU5HLFxuICAgICAgICAgICAgdXNlTmF0aXZlRHJpdmVyOiB0cnVlLFxuICAgICAgICAgIH0pLFxuICAgICAgICBdKS5zdGFydCgoeyBmaW5pc2hlZCB9KSA9PiB7XG4gICAgICAgICAgaWYgKGZpbmlzaGVkKSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzRmlyc3RET01Ob2RlKHRoaXMubWVudSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICApO1xuICB9O1xuXG4gIHByaXZhdGUgaGlkZSA9ICgpID0+IHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVycygpO1xuXG4gICAgY29uc3QgeyBhbmltYXRpb24gfSA9IHRoaXMucHJvcHMudGhlbWU7XG4gICAgQW5pbWF0ZWQudGltaW5nKHRoaXMuc3RhdGUub3BhY2l0eUFuaW1hdGlvbiwge1xuICAgICAgdG9WYWx1ZTogMCxcbiAgICAgIGR1cmF0aW9uOiBBTklNQVRJT05fRFVSQVRJT04gKiBhbmltYXRpb24uc2NhbGUsXG4gICAgICBlYXNpbmc6IEVBU0lORyxcbiAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICB9KS5zdGFydCgoeyBmaW5pc2hlZCB9KSA9PiB7XG4gICAgICBpZiAoZmluaXNoZWQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1lbnVMYXlvdXQ6IHsgd2lkdGg6IDAsIGhlaWdodDogMCB9LCByZW5kZXJlZDogZmFsc2UgfSk7XG4gICAgICAgIHRoaXMuc3RhdGUuc2NhbGVBbmltYXRpb24uc2V0VmFsdWUoeyB4OiAwLCB5OiAwIH0pO1xuICAgICAgICB0aGlzLmZvY3VzRmlyc3RET01Ob2RlKHRoaXMuYW5jaG9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgdmlzaWJsZSxcbiAgICAgIGFuY2hvcixcbiAgICAgIGNvbnRlbnRTdHlsZSxcbiAgICAgIHN0eWxlLFxuICAgICAgY2hpbGRyZW4sXG4gICAgICB0aGVtZSxcbiAgICAgIHN0YXR1c0JhckhlaWdodCxcbiAgICAgIG9uRGlzbWlzcyxcbiAgICAgIG92ZXJsYXlBY2Nlc3NpYmlsaXR5TGFiZWwsXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICBjb25zdCB7XG4gICAgICByZW5kZXJlZCxcbiAgICAgIG1lbnVMYXlvdXQsXG4gICAgICBhbmNob3JMYXlvdXQsXG4gICAgICBvcGFjaXR5QW5pbWF0aW9uLFxuICAgICAgc2NhbGVBbmltYXRpb24sXG4gICAgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICBsZXQgeyBsZWZ0LCB0b3AgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAvLyBJIGRvbid0IGtub3cgd2h5IGJ1dCBvbiBBbmRyb2lkIG1lYXN1cmUgZnVuY3Rpb24gaXMgd3JvbmcgYnkgMjRcbiAgICBjb25zdCBhZGRpdGlvbmFsVmVydGljYWxWYWx1ZSA9IFBsYXRmb3JtLnNlbGVjdCh7XG4gICAgICBhbmRyb2lkOiBzdGF0dXNCYXJIZWlnaHQsXG4gICAgICBkZWZhdWx0OiAwLFxuICAgIH0pO1xuXG4gICAgY29uc3Qgc2NhbGVUcmFuc2Zvcm1zID0gW1xuICAgICAge1xuICAgICAgICBzY2FsZVg6IHNjYWxlQW5pbWF0aW9uLnguaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFswLCBtZW51TGF5b3V0LndpZHRoXSxcbiAgICAgICAgICBvdXRwdXRSYW5nZTogWzAsIDFdLFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHNjYWxlWTogc2NhbGVBbmltYXRpb24ueS5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogWzAsIG1lbnVMYXlvdXQuaGVpZ2h0XSxcbiAgICAgICAgICBvdXRwdXRSYW5nZTogWzAsIDFdLFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgXTtcblxuICAgIGNvbnN0IHdpbmRvd0xheW91dCA9IERpbWVuc2lvbnMuZ2V0KCd3aW5kb3cnKTtcblxuICAgIC8vIFdlIG5lZWQgdG8gdHJhbnNsYXRlIG1lbnUgd2hpbGUgYW5pbWF0aW5nIHNjYWxlIHRvIGltaXRhdGUgdHJhbnNmb3JtIG9yaWdpbiBmb3Igc2NhbGUgYW5pbWF0aW9uXG4gICAgY29uc3QgcG9zaXRpb25UcmFuc2Zvcm1zID0gW107XG5cbiAgICAvLyBDaGVjayBpZiBtZW51IGZpdHMgaG9yaXpvbnRhbGx5IGFuZCBpZiBub3QgYWxpZ24gaXQgdG8gcmlnaHQuXG4gICAgaWYgKGxlZnQgPD0gd2luZG93TGF5b3V0LndpZHRoIC0gbWVudUxheW91dC53aWR0aCAtIFNDUkVFTl9JTkRFTlQpIHtcbiAgICAgIHBvc2l0aW9uVHJhbnNmb3Jtcy5wdXNoKHtcbiAgICAgICAgdHJhbnNsYXRlWDogc2NhbGVBbmltYXRpb24ueC5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogWzAsIG1lbnVMYXlvdXQud2lkdGhdLFxuICAgICAgICAgIG91dHB1dFJhbmdlOiBbLShtZW51TGF5b3V0LndpZHRoIC8gMiksIDBdLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayBpZiBtZW51IHBvc2l0aW9uIGhhcyBlbm91Z2ggc3BhY2UgZnJvbSBsZWZ0IHNpZGVcbiAgICAgIGlmIChsZWZ0IDwgU0NSRUVOX0lOREVOVCkge1xuICAgICAgICBsZWZ0ID0gU0NSRUVOX0lOREVOVDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcG9zaXRpb25UcmFuc2Zvcm1zLnB1c2goe1xuICAgICAgICB0cmFuc2xhdGVYOiBzY2FsZUFuaW1hdGlvbi54LmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgbWVudUxheW91dC53aWR0aF0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFttZW51TGF5b3V0LndpZHRoIC8gMiwgMF0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGxlZnQgKz0gYW5jaG9yTGF5b3V0LndpZHRoIC0gbWVudUxheW91dC53aWR0aDtcblxuICAgICAgY29uc3QgcmlnaHQgPSBsZWZ0ICsgbWVudUxheW91dC53aWR0aDtcbiAgICAgIC8vIENoZWNrIGlmIG1lbnUgcG9zaXRpb24gaGFzIGVub3VnaCBzcGFjZSBmcm9tIHJpZ2h0IHNpZGVcbiAgICAgIGlmIChyaWdodCA+IHdpbmRvd0xheW91dC53aWR0aCAtIFNDUkVFTl9JTkRFTlQpIHtcbiAgICAgICAgbGVmdCA9IHdpbmRvd0xheW91dC53aWR0aCAtIFNDUkVFTl9JTkRFTlQgLSBtZW51TGF5b3V0LndpZHRoO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIHRoZSBtZW51IGlzIGxhcmdlciB0aGFuIGF2YWlsYWJsZSB2ZXJ0aWNhbCBzcGFjZSxcbiAgICAvLyBjYWxjdWxhdGUgdGhlIGhlaWdodCBvZiBzY3JvbGxhYmxlIHZpZXdcbiAgICBsZXQgc2Nyb2xsYWJsZU1lbnVIZWlnaHQgPSAwO1xuXG4gICAgLy8gQ2hlY2sgaWYgdGhlIG1lbnUgc2hvdWxkIGJlIHNjcm9sbGFibGVcbiAgICBpZiAoXG4gICAgICAvLyBDaGVjayBpZiB0aGUgbWVudSBvdmVyZmxvd3MgZnJvbSBib3R0b20gc2lkZVxuICAgICAgdG9wID49XG4gICAgICAgIHdpbmRvd0xheW91dC5oZWlnaHQgLVxuICAgICAgICAgIG1lbnVMYXlvdXQuaGVpZ2h0IC1cbiAgICAgICAgICBTQ1JFRU5fSU5ERU5UIC1cbiAgICAgICAgICBhZGRpdGlvbmFsVmVydGljYWxWYWx1ZSAmJlxuICAgICAgLy8gQW5kIGJvdHRvbSBzaWRlIG9mIHRoZSBzY3JlZW4gaGFzIG1vcmUgc3BhY2UgdGhhbiB0b3Agc2lkZVxuICAgICAgdG9wIDw9IHdpbmRvd0xheW91dC5oZWlnaHQgLSB0b3BcbiAgICApIHtcbiAgICAgIC8vIFNjcm9sbGFibGUgbWVudSBzaG91bGQgYmUgYmVsb3cgdGhlIGFuY2hvciAoZXhwYW5kcyBkb3dud2FyZHMpXG4gICAgICBzY3JvbGxhYmxlTWVudUhlaWdodCA9XG4gICAgICAgIHdpbmRvd0xheW91dC5oZWlnaHQgLSB0b3AgLSBTQ1JFRU5fSU5ERU5UIC0gYWRkaXRpb25hbFZlcnRpY2FsVmFsdWU7XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIC8vIENoZWNrIGlmIHRoZSBtZW51IG92ZXJmbG93cyBmcm9tIGJvdHRvbSBzaWRlXG4gICAgICB0b3AgPj1cbiAgICAgICAgd2luZG93TGF5b3V0LmhlaWdodCAtXG4gICAgICAgICAgbWVudUxheW91dC5oZWlnaHQgLVxuICAgICAgICAgIFNDUkVFTl9JTkRFTlQgLVxuICAgICAgICAgIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlICYmXG4gICAgICAvLyBBbmQgdG9wIHNpZGUgb2YgdGhlIHNjcmVlbiBoYXMgbW9yZSBzcGFjZSB0aGFuIGJvdHRvbSBzaWRlXG4gICAgICB0b3AgPj0gd2luZG93TGF5b3V0LmhlaWdodCAtIHRvcCAmJlxuICAgICAgLy8gQW5kIG1lbnUgb3ZlcmZsb3dzIGZyb20gdG9wIHNpZGVcbiAgICAgIHRvcCA8PVxuICAgICAgICBtZW51TGF5b3V0LmhlaWdodCAtXG4gICAgICAgICAgYW5jaG9yTGF5b3V0LmhlaWdodCArXG4gICAgICAgICAgU0NSRUVOX0lOREVOVCAtXG4gICAgICAgICAgYWRkaXRpb25hbFZlcnRpY2FsVmFsdWVcbiAgICApIHtcbiAgICAgIC8vIFNjcm9sbGFibGUgbWVudSBzaG91bGQgYmUgYWJvdmUgdGhlIGFuY2hvciAoZXhwYW5kcyB1cHdhcmRzKVxuICAgICAgc2Nyb2xsYWJsZU1lbnVIZWlnaHQgPVxuICAgICAgICB0b3AgKyBhbmNob3JMYXlvdXQuaGVpZ2h0IC0gU0NSRUVOX0lOREVOVCArIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlO1xuICAgIH1cblxuICAgIC8vIFNjcm9sbGFibGUgbWVudSBtYXggaGVpZ2h0XG4gICAgc2Nyb2xsYWJsZU1lbnVIZWlnaHQgPVxuICAgICAgc2Nyb2xsYWJsZU1lbnVIZWlnaHQgPiB3aW5kb3dMYXlvdXQuaGVpZ2h0IC0gMiAqIFNDUkVFTl9JTkRFTlRcbiAgICAgICAgPyB3aW5kb3dMYXlvdXQuaGVpZ2h0IC0gMiAqIFNDUkVFTl9JTkRFTlRcbiAgICAgICAgOiBzY3JvbGxhYmxlTWVudUhlaWdodDtcblxuICAgIC8vIE1lbnUgaXMgdHlwaWNhbGx5IHBvc2l0aW9uZWQgYmVsb3cgdGhlIGVsZW1lbnQgdGhhdCBnZW5lcmF0ZXMgaXRcbiAgICAvLyBTbyBmaXJzdCBjaGVjayBpZiBpdCBmaXRzIGJlbG93IHRoZSBhbmNob3IgKGV4cGFuZHMgZG93bndhcmRzKVxuICAgIGlmIChcbiAgICAgIC8vIENoZWNrIGlmIG1lbnUgZml0cyB2ZXJ0aWNhbGx5XG4gICAgICB0b3AgPD1cbiAgICAgICAgd2luZG93TGF5b3V0LmhlaWdodCAtXG4gICAgICAgICAgbWVudUxheW91dC5oZWlnaHQgLVxuICAgICAgICAgIFNDUkVFTl9JTkRFTlQgLVxuICAgICAgICAgIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlIHx8XG4gICAgICAvLyBPciBpZiB0aGUgbWVudSBvdmVyZmxvd3MgZnJvbSBib3R0b20gc2lkZVxuICAgICAgKHRvcCA+PVxuICAgICAgICB3aW5kb3dMYXlvdXQuaGVpZ2h0IC1cbiAgICAgICAgICBtZW51TGF5b3V0LmhlaWdodCAtXG4gICAgICAgICAgU0NSRUVOX0lOREVOVCAtXG4gICAgICAgICAgYWRkaXRpb25hbFZlcnRpY2FsVmFsdWUgJiZcbiAgICAgICAgLy8gQW5kIGJvdHRvbSBzaWRlIG9mIHRoZSBzY3JlZW4gaGFzIG1vcmUgc3BhY2UgdGhhbiB0b3Agc2lkZVxuICAgICAgICB0b3AgPD0gd2luZG93TGF5b3V0LmhlaWdodCAtIHRvcClcbiAgICApIHtcbiAgICAgIHBvc2l0aW9uVHJhbnNmb3Jtcy5wdXNoKHtcbiAgICAgICAgdHJhbnNsYXRlWTogc2NhbGVBbmltYXRpb24ueS5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogWzAsIG1lbnVMYXlvdXQuaGVpZ2h0XSxcbiAgICAgICAgICBvdXRwdXRSYW5nZTogWy0oKHNjcm9sbGFibGVNZW51SGVpZ2h0IHx8IG1lbnVMYXlvdXQuaGVpZ2h0KSAvIDIpLCAwXSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgLy8gQ2hlY2sgaWYgbWVudSBwb3NpdGlvbiBoYXMgZW5vdWdoIHNwYWNlIGZyb20gdG9wIHNpZGVcbiAgICAgIGlmICh0b3AgPCBTQ1JFRU5fSU5ERU5UKSB7XG4gICAgICAgIHRvcCA9IFNDUkVFTl9JTkRFTlQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvc2l0aW9uVHJhbnNmb3Jtcy5wdXNoKHtcbiAgICAgICAgdHJhbnNsYXRlWTogc2NhbGVBbmltYXRpb24ueS5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogWzAsIG1lbnVMYXlvdXQuaGVpZ2h0XSxcbiAgICAgICAgICBvdXRwdXRSYW5nZTogWyhzY3JvbGxhYmxlTWVudUhlaWdodCB8fCBtZW51TGF5b3V0LmhlaWdodCkgLyAyLCAwXSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgdG9wICs9IGFuY2hvckxheW91dC5oZWlnaHQgLSAoc2Nyb2xsYWJsZU1lbnVIZWlnaHQgfHwgbWVudUxheW91dC5oZWlnaHQpO1xuXG4gICAgICBjb25zdCBib3R0b20gPVxuICAgICAgICB0b3AgK1xuICAgICAgICAoc2Nyb2xsYWJsZU1lbnVIZWlnaHQgfHwgbWVudUxheW91dC5oZWlnaHQpICtcbiAgICAgICAgYWRkaXRpb25hbFZlcnRpY2FsVmFsdWU7XG5cbiAgICAgIC8vIENoZWNrIGlmIG1lbnUgcG9zaXRpb24gaGFzIGVub3VnaCBzcGFjZSBmcm9tIGJvdHRvbSBzaWRlXG4gICAgICBpZiAoYm90dG9tID4gd2luZG93TGF5b3V0LmhlaWdodCAtIFNDUkVFTl9JTkRFTlQpIHtcbiAgICAgICAgdG9wID1cbiAgICAgICAgICBzY3JvbGxhYmxlTWVudUhlaWdodCA9PT0gd2luZG93TGF5b3V0LmhlaWdodCAtIDIgKiBTQ1JFRU5fSU5ERU5UXG4gICAgICAgICAgICA/IC1TQ1JFRU5fSU5ERU5UICogMlxuICAgICAgICAgICAgOiB3aW5kb3dMYXlvdXQuaGVpZ2h0IC1cbiAgICAgICAgICAgICAgbWVudUxheW91dC5oZWlnaHQgLVxuICAgICAgICAgICAgICBTQ1JFRU5fSU5ERU5UIC1cbiAgICAgICAgICAgICAgYWRkaXRpb25hbFZlcnRpY2FsVmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgc2hhZG93TWVudUNvbnRhaW5lclN0eWxlID0ge1xuICAgICAgb3BhY2l0eTogb3BhY2l0eUFuaW1hdGlvbixcbiAgICAgIHRyYW5zZm9ybTogc2NhbGVUcmFuc2Zvcm1zLFxuICAgICAgYm9yZGVyUmFkaXVzOiB0aGVtZS5yb3VuZG5lc3MsXG4gICAgICAuLi4oc2Nyb2xsYWJsZU1lbnVIZWlnaHQgPyB7IGhlaWdodDogc2Nyb2xsYWJsZU1lbnVIZWlnaHQgfSA6IHt9KSxcbiAgICB9O1xuXG4gICAgY29uc3QgcG9zaXRpb25TdHlsZSA9IHtcbiAgICAgIHRvcDogdGhpcy5pc0Nvb3JkaW5hdGUoYW5jaG9yKSA/IHRvcCA6IHRvcCArIGFkZGl0aW9uYWxWZXJ0aWNhbFZhbHVlLFxuICAgICAgLi4uKEkxOG5NYW5hZ2VyLmlzUlRMID8geyByaWdodDogbGVmdCB9IDogeyBsZWZ0IH0pLFxuICAgIH07XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXdcbiAgICAgICAgcmVmPXsocmVmKSA9PiB7XG4gICAgICAgICAgdGhpcy5hbmNob3IgPSByZWY7XG4gICAgICAgIH19XG4gICAgICAgIGNvbGxhcHNhYmxlPXtmYWxzZX1cbiAgICAgID5cbiAgICAgICAge3RoaXMuaXNDb29yZGluYXRlKGFuY2hvcikgPyBudWxsIDogYW5jaG9yfVxuICAgICAgICB7cmVuZGVyZWQgPyAoXG4gICAgICAgICAgPFBvcnRhbD5cbiAgICAgICAgICAgIDxUb3VjaGFibGVXaXRob3V0RmVlZGJhY2tcbiAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPXtvdmVybGF5QWNjZXNzaWJpbGl0eUxhYmVsfVxuICAgICAgICAgICAgICBhY2Nlc3NpYmlsaXR5Um9sZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgIG9uUHJlc3M9e29uRGlzbWlzc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFZpZXcgc3R5bGU9e1N0eWxlU2hlZXQuYWJzb2x1dGVGaWxsfSAvPlxuICAgICAgICAgICAgPC9Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2s+XG4gICAgICAgICAgICA8Vmlld1xuICAgICAgICAgICAgICByZWY9eyhyZWYpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUgPSByZWY7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIGNvbGxhcHNhYmxlPXtmYWxzZX1cbiAgICAgICAgICAgICAgYWNjZXNzaWJpbGl0eVZpZXdJc01vZGFsPXt2aXNpYmxlfVxuICAgICAgICAgICAgICBzdHlsZT17W3N0eWxlcy53cmFwcGVyLCBwb3NpdGlvblN0eWxlLCBzdHlsZV19XG4gICAgICAgICAgICAgIHBvaW50ZXJFdmVudHM9e3Zpc2libGUgPyAnYm94LW5vbmUnIDogJ25vbmUnfVxuICAgICAgICAgICAgICBvbkFjY2Vzc2liaWxpdHlFc2NhcGU9e29uRGlzbWlzc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEFuaW1hdGVkLlZpZXcgc3R5bGU9e3sgdHJhbnNmb3JtOiBwb3NpdGlvblRyYW5zZm9ybXMgfX0+XG4gICAgICAgICAgICAgICAgPFN1cmZhY2VcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtcbiAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgIHN0eWxlcy5zaGFkb3dNZW51Q29udGFpbmVyLFxuICAgICAgICAgICAgICAgICAgICAgIHNoYWRvd01lbnVDb250YWluZXJTdHlsZSxcbiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3R5bGUsXG4gICAgICAgICAgICAgICAgICAgIF0gYXMgU3R5bGVQcm9wPFZpZXdTdHlsZT5cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7KHNjcm9sbGFibGVNZW51SGVpZ2h0ICYmIChcbiAgICAgICAgICAgICAgICAgICAgPFNjcm9sbFZpZXc+e2NoaWxkcmVufTwvU2Nyb2xsVmlldz5cbiAgICAgICAgICAgICAgICAgICkpIHx8IDxSZWFjdC5GcmFnbWVudD57Y2hpbGRyZW59PC9SZWFjdC5GcmFnbWVudD59XG4gICAgICAgICAgICAgICAgPC9TdXJmYWNlPlxuICAgICAgICAgICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgPC9Qb3J0YWw+XG4gICAgICAgICkgOiBudWxsfVxuICAgICAgPC9WaWV3PlxuICAgICk7XG4gIH1cbn1cblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICB3cmFwcGVyOiB7XG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIH0sXG4gIHNoYWRvd01lbnVDb250YWluZXI6IHtcbiAgICBvcGFjaXR5OiAwLFxuICAgIHBhZGRpbmdWZXJ0aWNhbDogOCxcbiAgICBlbGV2YXRpb246IDgsXG4gIH0sXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgd2l0aFRoZW1lKE1lbnUpO1xuIl19